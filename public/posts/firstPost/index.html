<!DOCTYPE html>
<html lang="en" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <title>Rev sth :: Okoonzz&#39;s blog - Example site for hugo-theme-tailwind</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta
  name="description"
  content="HITCON_2023 Tải file tại đây. LessEQualmore Bài này dựa trên bài tham khảo của brosu (người đã hoàn thành trong giải) Trước khi tìm"
/>
<meta
  name="keywords"
  content="reverse"
/>
<meta name="robots" content="noodp" />
<meta property="og:url" content="http://localhost:1313/posts/firstpost/">
  <meta property="og:site_name" content="Okoonzz&#39;s blog">
  <meta property="og:title" content="Rev sth">
  <meta property="og:description" content="HITCON_2023 Tải file tại đây. LessEQualmore Bài này dựa trên bài tham khảo của brosu (người đã hoàn thành trong giải) Trước khi tìm">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-10T10:16:18+07:00">
    <meta property="article:modified_time" content="2024-05-10T10:16:18+07:00">

<meta name="twitter:card" content="summary"><meta name="twitter:title" content="Rev sth">
<meta name="twitter:description" content="HITCON_2023 Tải file tại đây. LessEQualmore Bài này dựa trên bài tham khảo của brosu (người đã hoàn thành trong giải) Trước khi tìm">


<link rel="canonical" href="http://localhost:1313/posts/firstpost/" />

<link rel="shortcut icon" href="/favicon.ico" />
<link rel="stylesheet" href="/css/index.e35987a77152345c1efaebd6ce6240488de0f6d5a0c1d19a843ff32bba9f70bb.css">





  






  
  

</head>
<body class="flex flex-col min-h-screen w-full bg-slate-50 dark:bg-gray-800">
    
<div class="fixed right-0 top-0 z-50 flex items-center justify-center bg-gray-200 p-2 text-sm uppercase text-black sm:bg-red-200 md:bg-yellow-200 lg:bg-green-200 xl:bg-blue-200 2xl:bg-pink-200">
  <span class="block sm:hidden">all</span>
  <span class="hidden sm:block md:hidden">sm</span>
  <span class="hidden md:block lg:hidden">md</span>
  <span class="hidden lg:block xl:hidden">lg</span>
  <span class="hidden xl:block 2xl:hidden">xl</span>
  <span class="hidden 2xl:block">2xl</span>
</div>

  <header class="flex flex-none justify-center z-10">
    <div class="flex flex-row gap justify-between w-full max-w-4xl lg:max-w-5xl h-12 mt-3">
  <div class="flex-none ml-2 md:ml-0">
    <a href="/" class="">
      <img class="h-12 w-12 rounded-full object-cover bg-gray-100" src="/images/logo.jpg" alt="logo">
    </a>
  </div>
  <div class="flex-1"></div>
  <div class="flex-none">
    



<nav class="h-full static">
  <button id="navbar-menu-toggle" type="button" class="inline-flex items-center p-2 text-sm text-slate-800 dark:text-slate-200 rounded-lg md:hidden" aria-controls="navbar-menu" aria-expanded="false">
    <span class="sr-only">Open main menu</span>
    <i class="w-8 h-8">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-menu-2" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M4 6l16 0" />
  <path d="M4 12l16 0" />
  <path d="M4 18l16 0" />
</svg>

    </i>
  </button>
  <div class="absolute md:static top-16 left-0 right-0 z-50 hidden w-full md:block md:w-auto" id="navbar-menu">
    <ul class="flex flex-col mx-2 md:mx-0 md:flex-row md:border-0 rounded-sm md:rounded-full px-3 text-base font-medium text-slate-800 dark:text-slate-200 shadow-lg bg-white dark:bg-gray-600 shadow-slate-800/5 dark:shadow-slate-200/5 ring-1 ring-slate-900/5 dark:ring-slate-100/5">
    
        <li id="about" class="">
          <a class="block px-3 py-3 hover:text-emerald-600"
            href="" title="About">About</a>
        </li>
      
    
        <li id="post" class="">
          <a class="block px-3 py-3 hover:text-emerald-600 text-emerald-600"
            href="/posts/" title="Post">Post</a>
        </li>
      
    
    </ul>
  </div>
</nav>


  </div>
  
  <div class="flex-none mx-1"></div>
  
  <div class="flex-none md:hidden">
    <a href=/search/ class="inline-flex items-center p-2 text-sm text-slate-800 dark:text-slate-200 rounded-lg" aria-controls="navbar-menu" aria-expanded="false">
      <span class="sr-only">Search</span>
      <i class="w-8 h-8">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
    <path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" />
    <path d="M21 21l-6 -6" />
</svg>

      </i>
    </a>
  </div>
  <div class="darkmode-toggle flex flex-none mr-2 md:mr-0">
    <label for="darkmode-toggle" class="flex items-center px-3 cursor-pointer rounded-full bg-gray-100 dark:bg-gray-600" title="Toggle dark mode">
      <input name="darkmode-toggle" id="darkmode-toggle" type="checkbox" class="sr-only peer" aria-label="Toggle dark mode">
      <div class="group flex flex-row gap-1 justify-center h-8 px-1 rounded-full bg-white dark:bg-gray-700">
        <i class="h-6 w-6 flex-none rounded-full bg-yellow-400 place-self-center peer-checked:group-[]:invisible">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brightness-down" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M12 12m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0"></path>
   <path d="M12 5l0 .01"></path>
   <path d="M17 7l0 .01"></path>
   <path d="M19 12l0 .01"></path>
   <path d="M17 17l0 .01"></path>
   <path d="M12 19l0 .01"></path>
   <path d="M7 17l0 .01"></path>
   <path d="M5 12l0 .01"></path>
   <path d="M7 7l0 .01"></path>
</svg>

        </i>
        <i class="h-6 w-6 flex-none rounded-full place-self-center invisible peer-checked:group-[]:visible">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-moon-stars" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
   <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"></path>
   <path d="M19 11h2m-1 -1v2"></path>
</svg>

        </i>
      </div>
    </label>
  </div>
</div>

  </header>
  <main class="flex flex-auto justify-center">
    
<div class="w-full max-w-4xl lg:max-w-5xl">
  <div class="flex flex-col mt-6 mx-2 md:mx-0 rounded-lg overflow-hidden shadow-md bg-white dark:bg-gray-700">
    <div>
      <a href="/posts/firstpost/">
        <picture>
    <source type="image/webp" srcset="" sizes="(min-width: 1024px) 100vw, 50vw" />
    <source type="image/jpeg" srcset="" sizes="(min-width: 1024px) 100vw, 50vw" />
    <img class="w-full object-cover h-36 md:h-48 xl:h-60" src="/posts/firstpost/img1_hubb1af3451800ddf19140b08178c75f0f_192216_640x0_resize_q75_bgffffff_box_3.jpg" width="428" height="325" alt="Rev sth" title="Rev sth" loading="lazy" />
  </picture>
      </a>
    </div>
    <div class="flex flex-col gap-y-3 p-6">
      <h1 class="text-4xl font-semibold text-slate-800 dark:text-slate-100">
        <a href="/posts/firstpost/">Rev sth</a>
      </h1>

      
      


      <div class="flex flex-col gap-y-1 md:flex-row md:gap-y-0 md:gap-x-4 text-slate-500 dark:text-slate-300">
  
  
  <div class="flex flex-row text-base gap-x-1">
    <i class="h-6 w-6 flex-none">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M4 7a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12z"></path>
   <path d="M16 3v4"></path>
   <path d="M8 3v4"></path>
   <path d="M4 11h16"></path>
   <path d="M11 15h1"></path>
   <path d="M12 15v3"></path>
</svg>

    </i>
    <time datetime="2024-05-10T10:16:18&#43;07:00">
      2024-05-10
    </time>
  </div>

  <div class="flex flex-row text-base gap-x-1">
    <i class="h-6 w-6 flex-none">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hourglass-high" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M6.5 7h11"></path>
   <path d="M6 20v-2a6 6 0 1 1 12 0v2a1 1 0 0 1 -1 1h-10a1 1 0 0 1 -1 -1z"></path>
   <path d="M6 4v2a6 6 0 1 0 12 0v-2a1 1 0 0 0 -1 -1h-10a1 1 0 0 0 -1 1z"></path>
</svg>

    </i>
    <span>
      22 minutes to read
    </span>
  </div>
</div>


      
        
        <section class="prose prose-slate dark:prose-invert w-full max-w-4xl lg:max-w-5xl mt-6">
          <h2>Table of Contents</h2>
          <aside><nav id="TableOfContents">
  <ul>
    <li><a href="#lessequalmore">LessEQualmore</a></li>
    <li><a href="#crazyarcade">CrazyArcade</a></li>
    <li><a href="#the-blade-rust">The-blade (Rust)</a></li>
  </ul>
</nav></aside>
        </section>
        
      

      <article class="mt-6 w-full max-w-4xl lg:max-w-5xl prose prose-slate dark:prose-invert prose-quoteless post-content">
        <h1 id="hitcon_2023">HITCON_2023</h1>
<p><em>Tải file <a href="https://github.com/Okoonzz/07.-Rev/blob/File/Hitcon2023.zip" target="_blank" rel="noopener">tại đây.</a>
</em></p>
<h2 id="lessequalmore">LessEQualmore</h2>
<p><em>Bài này dựa trên bài tham khảo của brosu (người đã hoàn thành trong giải)</em></p>
<p>Trước khi tìm hiểu cách giải bài này ta sẽ cùng tham khảo qua bài viết <a href="https://towardsdatascience.com/essential-math-for-data-science-matrices-as-linear-transformations-6d1d0e628131" target="_blank" rel="noopener">tại đây.</a>
</p>
<p>Bài này đầu tiên khi debug thật sự cũng chả thấy gì, ngoài thấy chỉ load nội dung ở file <code>chal.txt</code> vào (nhưng có lẽ sẽ rất khó thấy quy luật bởi có lúc thì nó sẽ nhảy tới 3 có lúc thì nhảy tới 6) và sau đó nhập vào để check flag. Sau khi một hồi ngồi decompile lại toàn bộ nội dung của chương trình, thì sẽ thấy được đây chính là một bài <code>vm</code> dùng để check flag.</p>
<p>Không hiểu sao lần này IDA trả về mã giả khá ngu. Đây chính là nội dung mà IDA trả về:</p>
<p><div class="not-prose">
<figure>
    <img src="https://hackmd.io/_uploads/HJa3t8x1p.png"
      alt="" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>Nếu để ý kỹ hơn thì ta sẽ so sánh với ASM như sau:</p>
<p><div class="not-prose">
<figure>
    <img src="https://hackmd.io/_uploads/H13CtLxJ6.png"
      alt="" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>Ta thấy được ở ASM chỉ với hai biến được sử dụng đó là <code>v1</code> và <code>re</code> nhưng ở mã giả trả về lại tới 3.  ¯_(ツ)_/¯</p>
<p>Vì đoạn mã ASM này cũng khá ngắn nên mình đã quyết định viết lại nó và đây là toàn bộ đoạn mã của chương trình:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">mem</span> <span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">is_negative</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">getchar</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">ip</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&#34;Enter char: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">ip</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_bignum</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">v1</span> <span class="p">:</span> <span class="nb">str</span>
</span></span><span class="line"><span class="cl">    <span class="n">ret</span> <span class="p">:</span> <span class="nb">int</span>
</span></span><span class="line"><span class="cl">    <span class="n">v1</span> <span class="o">=</span> <span class="n">getchar</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">v1</span> <span class="o">==</span> <span class="s1">&#39;%&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">v1</span> <span class="o">=</span> <span class="n">getchar</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">v1</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">ret</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">            <span class="n">v1</span> <span class="o">=</span> <span class="n">getchar</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="k">while</span> <span class="n">v1</span> <span class="o">!=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">ret</span> <span class="o">*=</span> <span class="mi">16</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="nb">ord</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">64</span> <span class="ow">or</span> <span class="nb">ord</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">70</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="nb">ord</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span>  <span class="o">&lt;=</span> <span class="mi">96</span> <span class="ow">or</span> <span class="nb">ord</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">102</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                        <span class="n">ret</span> <span class="o">+=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">48</span>
</span></span><span class="line"><span class="cl">                    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                        <span class="n">ret</span> <span class="o">+=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">87</span>
</span></span><span class="line"><span class="cl">                <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">ret</span> <span class="o">+=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">55</span>
</span></span><span class="line"><span class="cl">                <span class="n">v1</span> <span class="o">=</span> <span class="n">getchar</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="nb">ord</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mh">0x78</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">v1</span> <span class="o">==</span> <span class="s1">&#39;%&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">ret</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="k">return</span> <span class="o">-</span><span class="n">ret</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="nb">ord</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mh">0x25</span> <span class="ow">and</span> <span class="nb">ord</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">48</span> <span class="o">&lt;=</span> <span class="mi">9</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">ret</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">48</span>
</span></span><span class="line"><span class="cl">                    <span class="n">v1</span>  <span class="o">=</span> <span class="n">getchar</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">                    <span class="k">while</span> <span class="n">v1</span> <span class="o">!=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                        <span class="n">ret</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">ret</span> <span class="o">+</span> <span class="nb">ord</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">48</span>
</span></span><span class="line"><span class="cl">                        <span class="n">v1</span> <span class="o">=</span> <span class="n">getchar</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">                    <span class="k">return</span> <span class="o">-</span><span class="n">ret</span>
</span></span><span class="line"><span class="cl">                <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="k">return</span> <span class="o">-</span> <span class="nb">ord</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="o">-</span><span class="nb">ord</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="o">-</span><span class="nb">ord</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">bignum_sub</span><span class="p">(</span><span class="n">a1</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">a2</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">a2</span> <span class="o">-</span> <span class="n">a1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">op1</span><span class="p">(</span><span class="n">a1</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">a2</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">bignum</span> <span class="p">:</span> <span class="nb">int</span>
</span></span><span class="line"><span class="cl">    <span class="n">tmp1</span> <span class="o">=</span> <span class="n">is_negative</span><span class="p">(</span><span class="n">a1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">tmp2</span> <span class="o">=</span> <span class="n">is_negative</span><span class="p">(</span><span class="n">a2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">tmp1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">bignum</span> <span class="o">=</span> <span class="n">get_bignum</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">bignum</span> <span class="o">=</span> <span class="n">mem</span><span class="p">[</span><span class="n">a1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">tmp2</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">bignum</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">mem</span><span class="p">[</span><span class="n">a2</span><span class="p">]</span> <span class="o">=</span> <span class="n">bignum_sub</span><span class="p">(</span><span class="n">bignum</span><span class="p">,</span> <span class="n">mem</span><span class="p">[</span><span class="n">a2</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">runProg</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">     <span class="n">ins</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">     <span class="k">while</span> <span class="n">ins</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">          <span class="n">op1</span><span class="p">(</span><span class="n">mem</span><span class="p">[</span><span class="n">ins</span><span class="p">],</span> <span class="n">mem</span><span class="p">[</span><span class="n">ins</span> <span class="o">+</span><span class="mi">1</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">          <span class="k">if</span> <span class="n">mem</span><span class="p">[</span><span class="n">mem</span><span class="p">[</span><span class="n">ins</span> <span class="o">+</span><span class="mi">1</span><span class="p">]]</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">               <span class="n">ins</span> <span class="o">=</span> <span class="n">mem</span><span class="p">[</span><span class="n">ins</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">          <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">               <span class="n">ins</span> <span class="o">+=</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">readProg</span><span class="p">(</span><span class="n">filename</span> <span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&#34;r&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">			<span class="n">mem</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2"> &#34;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34; &#34;</span><span class="p">)])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">readProg</span><span class="p">(</span><span class="s2">&#34;chal.txt&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">runProg</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">	<span class="n">main</span><span class="p">()</span>
</span></span></code></pre></div><blockquote>
<p>Toàn bộ hàm trên mình đã decompile bằng IDA chỉ có readProg là tham khảo thêm của brosu (vì dài quá nên mình lười :)) )</p>
</blockquote>
<p>Có thể kiểm tra double check với debug. Qua đó ta sẽ thấy rõ hơn đây chính là <code>vm</code> và nó sẽ check từng chữ. Nhưng check bằng cách nào ??? Ta sẽ tiến hành đào sâu vào nó.</p>
<p>Đầu tiên với <code>getchar</code> ta sẽ thử đổi lại lưu toàn bộ <code>input</code> vào thay vì chỉ lưu từng ký tự:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">strBuf</span> <span class="p">:</span> <span class="nb">str</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">getchar</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">global</span> <span class="n">strBuf</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">strBuf</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">ip</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">ip</span> <span class="o">=</span> <span class="n">strBuf</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">strBuf</span> <span class="o">=</span> <span class="n">strBuf</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">ip</span>
</span></span></code></pre></div><blockquote>
<p><code>VM</code> có đặc tính đó chính là chạy những <code>ins</code> để setup và sau đó sẽ thao tác với đầu vào và sau cùng là so sánh trên những <code>ins</code> đó, đặc biệt mỗi lần chạy và setup như thế thì nó chỉ thao tác với đúng một ký tự trong flag, và nếu chỉ 1 chữ sai thì sẽ trả về toàn bộ sai, đôi khi cũng có những chương trình không cần detect 1 chữ sai thì sẽ trả về sai mà nó vẫn sẽ lưu lại đó và thao tác tiếp những ký tự tiếp theo nhưng khi thao tác ký tự mới thì nó sẽ load lại những <code>ins</code>.</p>
</blockquote>
<p>Bây giờ, ta sẽ kiểm tra xem nó đang thực sự làm gì với đầu vào, ta sẽ đặt <code>cnt</code> tại hàm <code>runProg()</code> để đếm xem số lần chạy những <code>ins</code> cho những lần ký tự được nhập vào. Có vẻ như chương trình không phải là loại nếu gặp 1 ký tự sai thì thoát ngay, nên mình sẽ tận dụng điều này để nhập mỗi lần một tăng dần cho chương trình. Nó cũng giống như cách mình brute, ví dụ nó sẽ dựa vào những chữ đúng phía trước rồi sẽ brute ký tự tiếp theo, còn đối với bài này thì tương tự như thế nhưng bây giờ sẽ ví dụ như mình vẫn chưa biết được các ký tự đầu tiên là gì nên mình sẽ nhập lần lượt <code>a, aa, aaa,...</code> :</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">inList</span> <span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">plotgrap</span><span class="p">(</span><span class="n">inList</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]):</span>
</span></span><span class="line"><span class="cl">    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">inList</span><span class="p">))],</span> <span class="n">inList</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">global</span> <span class="n">strBuf</span>
</span></span><span class="line"><span class="cl">    <span class="k">global</span> <span class="n">inList</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">strBuf</span> <span class="o">=</span> <span class="s2">&#34;a&#34;</span><span class="o">*</span><span class="n">i</span>
</span></span><span class="line"><span class="cl">        <span class="n">readProg</span><span class="p">(</span><span class="s2">&#34;chal.txt&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">inList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">runProg</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">strBuf</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">plotgrap</span><span class="p">(</span><span class="n">inList</span><span class="p">)</span>
</span></span></code></pre></div><p><div class="not-prose">
<figure>
    <img src="https://hackmd.io/_uploads/B17aUsg1a.png"
      alt="" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>Ta sẽ nhận được một đồ thị như hình trên, với trục hoành là số ký tự nhập vào, còn trục tung là số <code>ins</code> sau tất cả lần chạy với những ký tự nhập vào.</p>
<p>Thấy được rằng 7 chunk đầu tiên mỗi chunk gồm 8 ký tự được phân chia khá rõ ràng.</p>
<p>Vì đã biết được đầu flag có dạng <code>hitcon{</code> nhưng dạng này chỉ có 7 ký tự, nhưng trên hình mình đã đoán nó phải 8 ký tự nên sẽ brute ký tự còn lại. Cách brute được thực hiện như sau:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">inList</span> <span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="n">charList</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">plotgrap</span><span class="p">(</span><span class="n">charList</span><span class="p">,</span> <span class="n">inList</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]):</span>
</span></span><span class="line"><span class="cl">    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">charList</span><span class="p">,</span> <span class="n">inList</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">global</span> <span class="n">strBuf</span>
</span></span><span class="line"><span class="cl">    <span class="k">global</span> <span class="n">inList</span>
</span></span><span class="line"><span class="cl">    <span class="k">global</span> <span class="n">charList</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">printable</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">charList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">strBuf</span> <span class="o">=</span> <span class="s2">&#34;hitcon{&#34;</span> <span class="o">+</span> <span class="n">ch</span>
</span></span><span class="line"><span class="cl">        <span class="n">readProg</span><span class="p">(</span><span class="s2">&#34;chal.txt&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">inList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">runProg</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">strBuf</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">plotgrap</span><span class="p">(</span><span class="n">charList</span><span class="p">,</span> <span class="n">inList</span><span class="p">)</span>
</span></span></code></pre></div><p><div class="not-prose">
<figure>
    <img src="https://hackmd.io/_uploads/B1_3poxka.png"
      alt="" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>Để ý thấy được số lượng <code>ins</code> tăng đột biến ở <code>r</code> nên khả năng cao 8 bytes đầu của flag là <code>hitcon{r</code></p>
<p>Ta sẽ thử lại một lần nữa và đây chính là kết quả:</p>
<p><div class="not-prose">
<figure>
    <img src="https://hackmd.io/_uploads/SyQPCoeJT.png"
      alt="" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>Thấy được lúc đầu 7 chunk, lúc sau chỉ còn 6 chunk vậy giả thiết ban đầu đã đúng. Chương trình được chia làm 8 chunk mỗi chunk có 8 bytes để so sánh. (vì rất có thể chunk cuối cùng không có sự phân chia vì nó đã sai hoàn toàn nên nó sẽ dính liền với những ký tự rác phía sau)</p>
<p>Vậy câu hỏi bây giờ là có brute được không ?? Có thể là không bởi brute một lần 8 byte mà tới 256 ký tự, =)))</p>
<p>Vì đã viết ra được chương trình, nên ta sẽ xem trong số các <code>ins</code> load vào để thực hiện <code>vm</code> đó thì đâu là nơi chúng lưu những byte đầu tiên của input. Vì như đã nói ban đầu <code>ins</code> không chỉ có thao tác và kiểm tra mà nó còn thêm cả setup nên không đoán được chúng sẽ lưu ở đâu.</p>
<p>Vì mem chỉ thao tác ở hàm <code>runProg()</code> nên ta sẽ đào sâu việc tìm mem ở đây:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">runProg</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">ins</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="n">ins</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">cnt</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="n">op1</span><span class="p">(</span><span class="n">mem</span><span class="p">[</span><span class="n">ins</span><span class="p">],</span> <span class="n">mem</span><span class="p">[</span><span class="n">ins</span> <span class="o">+</span><span class="mi">1</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">mem</span><span class="p">[</span><span class="n">mem</span><span class="p">[</span><span class="n">ins</span> <span class="o">+</span><span class="mi">1</span><span class="p">]]</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">               <span class="n">ins</span> <span class="o">=</span> <span class="n">mem</span><span class="p">[</span><span class="n">ins</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">               <span class="n">ins</span> <span class="o">+=</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">cnt</span> <span class="o">%</span> <span class="mi">1500</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mem</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">mem</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">8</span><span class="p">]</span> <span class="o">==</span> <span class="p">[</span><span class="mi">104</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">123</span><span class="p">,</span> <span class="mi">114</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;idx: </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">cnt</span>
</span></span><span class="line"><span class="cl"><span class="c1"># output: 16</span>
</span></span></code></pre></div><p>Như vậy đã xác định được vị trí đầu tiên lưu đầu vào nhập vào chính là <code>mem[16]</code></p>
<p>Có được vị trí đầu vào tiếp đến, ta sẽ xem xem sau khi chạy xong <code>vm</code> thì đầu ra của ta sẽ nhận được những gì. Vì như đã nói ban đầu bài này phải nhập hết rồi nó sẽ kiểm tra từng từ nên mình sẽ giả dụ như đã nhập đủ flag và xem kết quả được in ra:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">global</span> <span class="n">strBuf</span>
</span></span><span class="line"><span class="cl">    <span class="k">global</span> <span class="n">inList</span>
</span></span><span class="line"><span class="cl">    <span class="k">global</span> <span class="n">charList</span>
</span></span><span class="line"><span class="cl">    <span class="n">strBuf</span> <span class="o">=</span> <span class="s1">&#39;hitcon{r&#39;</span> <span class="o">+</span> <span class="s1">&#39;aaaaaaaa&#39;</span> <span class="o">+</span> <span class="s1">&#39;aaaaaaaa&#39;</span> <span class="o">+</span> <span class="s1">&#39;aaaaaaaa&#39;</span> <span class="o">+</span> <span class="s1">&#39;aaaaaaaa&#39;</span> <span class="o">+</span> <span class="s1">&#39;aaaaaaaa&#39;</span> <span class="o">+</span> <span class="s1">&#39;aaaaaaaa&#39;</span> <span class="o">+</span> <span class="s1">&#39;aaaaaaaa&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">tmp</span> <span class="o">=</span> <span class="n">strBuf</span>
</span></span><span class="line"><span class="cl">    <span class="n">readProg</span><span class="p">(</span><span class="s2">&#34;chal.txt&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">runProg</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">tmp</span><span class="p">),</span><span class="mi">8</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">mem</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">8</span><span class="p">],</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># output: [16774200, 1411, 16776275, 3646, 1532, 6451, 2510, 16777141] [16774500, 1164, 16776343, 3298, 1261, 5626, 2328, 0] [16774500, 1164, 16776343, 3298, 1261, 5626, 2328, 0] [16774500, 1164, 16776343, 3298, 1261, 5626, 2328, 0] [16774500, 1164, 16776343, 3298, 1261, 5626, 2328, 0] [16774500, 1164, 16776343, 3298, 1261, 5626, 2328, 0]</span>
</span></span></code></pre></div><p>Tương tự như lúc debug, ta sẽ thử thay đổi 1 ký tự trong chuỗi <code>aaaaaaaa</code> thành <code>aaaaaaab</code> để xem nó thành gì. Và đây là kết quả:</p>
<pre tabindex="0"><code>[16774200, 1411, 16776275, 3646, 1532, 6451, 2510, 16777141]
[16774493, 1161, 16776349, 3305, 1265, 5634, 2341, 15]
[16774500, 1164, 16776343, 3298, 1261, 5626, 2328, 0]
[16774500, 1164, 16776343, 3298, 1261, 5626, 2328, 0]
[16774500, 1164, 16776343, 3298, 1261, 5626, 2328, 0]
[16774500, 1164, 16776343, 3298, 1261, 5626, 2328, 0]
</code></pre><p>Thấy rằng từ hàng thứ 2 và những hàng sau có sự thay đổi khi thay giá trị. Cụ thể nó đã thay đổi một lượng <code>-7	-3	6	7	4	8	13	15</code>, những dãy dưới tương tự vì cùng <code>aaaaaaaa</code> không thay đổi. Làm tương tự cho các index còn lại của <code>aaaaaaaa</code> ví dụ tiếp đến thành <code>aaaaaaba</code> ,&hellip;
ta sẽ thu được bảng như sau:</p>
<pre tabindex="0"><code>-7	-3	6	7	4	8	13	15
-2	11	-2	2	9	20	-6	-11
-13	-10	-5	17	-8	1	22	15
4 	6 	4 	-6 	6 	5 	-8 	-5
-4 	5 	-3 	5 	3 	13 	1 	-6
3 	2 	-3 	-3 	-1 	-2 	-6 	-8
-2 	3 	-4 	3 	2 	7 	-1 	-5 
-7 	-2 	-2 	9 	-2 	6 	9 	5 
</code></pre><p>Vậy tổng quan của chương trình đó là <code>input -&gt; 8 chunk -&gt; biến đổi qua những hằng số nhất định -&gt; so sánh với enc</code></p>
<p>Như bài viết đã tham khảo ban đầu 8 chunk chúng biến đổi qua những hằng số và có kết quả mới, thì cũng tương tự như việc nhân ma trận AX với A là ma trận chứa -7,-3,&hellip; còn X là ma trận chứa 8 chunk. Việc cuối cùng ta chỉ cần giải phương trình AX=B là hoàn tất</p>
<p>Đây là script giải của bài này:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span><span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">A</span> <span class="o">=</span> <span class="p">[[</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">13</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">11</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">15</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">Zmod</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">24</span><span class="p">),</span><span class="n">A</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1"># print(y)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">chal</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">16774200</span><span class="p">,</span> <span class="mi">1411</span><span class="p">,</span> <span class="mi">16776275</span><span class="p">,</span> <span class="mi">3646</span><span class="p">,</span> <span class="mi">1532</span><span class="p">,</span> <span class="mi">6451</span><span class="p">,</span> <span class="mi">2510</span><span class="p">,</span> <span class="mi">16777141</span><span class="p">],</span> <span class="p">[</span><span class="mi">16775256</span><span class="p">,</span> <span class="mi">2061</span><span class="p">,</span> <span class="mi">16776706</span><span class="p">,</span> <span class="mi">2260</span><span class="p">,</span> <span class="mi">2107</span><span class="p">,</span> <span class="mi">6124</span><span class="p">,</span> <span class="mi">878</span><span class="p">,</span> <span class="mi">16776140</span><span class="p">],</span> <span class="p">[</span><span class="mi">16775299</span><span class="p">,</span> <span class="mi">1374</span><span class="p">,</span> <span class="mi">16776956</span><span class="p">,</span> <span class="mi">2212</span><span class="p">,</span> <span class="mi">1577</span><span class="p">,</span> <span class="mi">4993</span><span class="p">,</span> <span class="mi">1351</span><span class="p">,</span> <span class="mi">16777040</span><span class="p">],</span> <span class="p">[</span><span class="mi">16774665</span><span class="p">,</span> <span class="mi">1498</span><span class="p">,</span> <span class="mi">16776379</span><span class="p">,</span> <span class="mi">3062</span><span class="p">,</span> <span class="mi">1593</span><span class="p">,</span> <span class="mi">5966</span><span class="p">,</span> <span class="mi">1924</span><span class="p">,</span> <span class="mi">16776815</span><span class="p">],</span> <span class="p">[</span><span class="mi">16774318</span><span class="p">,</span> <span class="mi">851</span><span class="p">,</span> <span class="mi">16775763</span><span class="p">,</span> <span class="mi">3663</span><span class="p">,</span> <span class="mi">711</span><span class="p">,</span> <span class="mi">5193</span><span class="p">,</span> <span class="mi">2591</span><span class="p">,</span> <span class="mi">16777069</span><span class="p">],</span> <span class="p">[</span><span class="mi">16774005</span><span class="p">,</span> <span class="mi">1189</span><span class="p">,</span> <span class="mi">16776283</span><span class="p">,</span> <span class="mi">3892</span><span class="p">,</span> <span class="mi">1372</span><span class="p">,</span> <span class="mi">6362</span><span class="p">,</span> <span class="mi">2910</span><span class="p">,</span> <span class="mi">307</span><span class="p">],</span> <span class="p">[</span><span class="mi">16775169</span><span class="p">,</span> <span class="mi">1031</span><span class="p">,</span> <span class="mi">16776798</span><span class="p">,</span> <span class="mi">2426</span><span class="p">,</span> <span class="mi">1171</span><span class="p">,</span> <span class="mi">4570</span><span class="p">,</span> <span class="mi">1728</span><span class="p">,</span> <span class="mi">33</span><span class="p">],</span> <span class="p">[</span><span class="mi">16775201</span><span class="p">,</span> <span class="mi">819</span><span class="p">,</span> <span class="mi">16776898</span><span class="p">,</span> <span class="mi">2370</span><span class="p">,</span> <span class="mi">1132</span><span class="p">,</span> <span class="mi">4255</span><span class="p">,</span> <span class="mi">1900</span><span class="p">,</span> <span class="mi">347</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">tar</span> <span class="ow">in</span> <span class="n">chal</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">target</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">tar</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">decr</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">target</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">decr</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="crazyarcade">CrazyArcade</h2>
<p>Đây là một bài chạy với file .exe. Ta sẽ mở phân tích nó bằng IDA</p>
<p><div class="not-prose">
<figure>
    <img src="https://hackmd.io/_uploads/rJF400E16.png"
      alt="" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>Đầu tiên với hàm main, hầu như đã có tất cả symbol nên việc nhìn thấy công dụng của chúng khá dễ dàng, chỉ phát hiện duy nhất một hàm này:</p>
<p><div class="not-prose">
<figure>
    <img src="https://hackmd.io/_uploads/H1WuRCEy6.png"
      alt="" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>Tiến hành đào sâu vào bên trong hàm này:</p>
<p><div class="not-prose">
<figure>
    <img src="https://hackmd.io/_uploads/H1Xc00Vyp.png"
      alt="" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>Có thể thấy được sơ lược qua, đầu tiên nó sẽ cop một file có nội dung là <code>CrazyArcade.sys</code> tiếp đến nó load số lượng ký tự vào buffer rồi tiếp đến nó đang bảo phải chạy dưới quyền admin. Tiếp đến một <code>hDevice</code> được tạo, ta đã biết được thường các <code>hDevice</code> tạo ra nhằm mục đích để chuyển hướng chương trình đang chạy đến một chương trình khác.</p>
<p><div class="not-prose">
<figure>
    <img src="https://hackmd.io/_uploads/Sk8rlJSka.png"
      alt="" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>Tiếp đến, chương trình load một lượng dữ liệu vào buffer, ta có thể nhận biết được bằng symbol <a href="https://learn.microsoft.com/en-us/windows/win32/api/ioapiset/nf-ioapiset-deviceiocontrol" target="_blank" rel="noopener">DeviceIoControl</a>
, sau cùng thì chương trình load những hiệu ứng của trò chơi vào và chạy chương trình.</p>
<p>Debug chương trình này, bắt gặp được đoạn code để chạy con game nằm ở đây:</p>
<p><div class="not-prose">
<figure>
    <img src="https://hackmd.io/_uploads/rymzZkry6.png"
      alt="" 
      loading="lazy"
    >
  </figure></div>
</p>
<p><div class="not-prose">
<figure>
    <img src="https://hackmd.io/_uploads/rydIb1HJp.png"
      alt="" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>Bên trong hàm này, nếu debug hoàn toàn thì chỉ có thể thấy được dường như nó chỉ chạy chương trình, và chả có gì đặc biệt ở đây.</p>
<p>Nhưng ta sẽ thử tham khảo thử <code>DeviceIoControl</code> nó được lấy từ đâu, bởi vì nếu chơi chiến thắng game có flag thì có lẽ weight đã không tới 100 =))) và hơn thế nữa tại sao lại chỉ trò chơi, nhưng điều khiển chương trình thực thi một chương trình khác làm gì ??</p>
<p>Đây là kết quả nhận lại được:</p>
<p><div class="not-prose">
<figure>
    <img src="https://hackmd.io/_uploads/S1QlMyrJa.png"
      alt="" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>Có thể thấy chỉ có 2 hàm duy nhất của chương trình chứa <code>DeviceIoControl</code> đó là hàm đang phân tích và một hàm nữa có tên <code>sub_7FF6930B30A0</code> <em>(vì chương trình đã debug nên nó đã cộng thêm imagebase nhưng có thể check bằng 4 số cuối)</em></p>
<p>Khi vào hàm này và đây là kết quả:</p>
<p><div class="not-prose">
<figure>
    <img src="https://hackmd.io/_uploads/S15vMkHkT.png"
      alt="" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>Ở đây, hình như đang thực hiện xor một thứ gì đó, static đối với những người lâu năm thì có lẽ khá dễ dàng nhận ra, nhưng với mình mình sẽ debug đoạn này để xem nó đang xor cái gì ở đây.</p>
<p><div class="not-prose">
<figure>
    <img src="https://hackmd.io/_uploads/HJYDHyr1T.png"
      alt="" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>Đầu tiên nó đang load một dữ liệu từ đâu đó</p>
<p><div class="not-prose">
<figure>
    <img src="https://hackmd.io/_uploads/rJYtrkH1p.png"
      alt="" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>Tiếp đến nó load dữ liệu được lấy từ đoạn phân tích với <code>DeviceIoControl</code> ở trên, sau cùng nó tiến hành 2 lần xor. Một lần xor với <code>r8d</code> và một lần xor với <code>ecx</code>.</p>
<blockquote>
<p>Ở đây mình đã cố tình patch lại để cho có thể nhảy trực tiếp vào đoạn xor này, có thể nói là không theo dự định của tác giả, vì sau nhiều lần debug kể cả có kill được những con bot hay thua hay di chuyển trong game thì mình vẫn ko thể debug theo ý muốn được, từng bước di chuyển hay khi giết hoặc chết mặc dù đang debug nhưng IDA vẫn không detect được. Ý định ban đầu muốn thử xem các sự kiện trong game sau mỗi lần thao tác có dừng lại để chạy asm được hay không ?? Nhưng không thể.</p>
</blockquote>
<p>Vậy công việc cuối cùng bây giờ ta phải xác định được dữ liệu khi load vào <code>ecx</code> được lấy từ đâu ? Nếu nhìn kĩ lại chương trình này nó còn gọi một chương trình khác có cùng tên nhưng file là <code>.sys</code>. Ta sẽ mở file này lên xem có gì ở đây.</p>
<p><div class="not-prose">
<figure>
    <img src="https://hackmd.io/_uploads/SyWOuJByT.png"
      alt="" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>File này có rất nhiều hàm nhưng đa số được sử dụng hàm <code>sub_11450</code>. Nếu đã từng làm ở giải SEKAI, thì ở giải đó chính là phân tích thẳng kernel, đây cũng tương tự, nó đang tạo ra một drive để thực hiện một số điều gì đó, ta kiểm tra hàm được sử dụng nhiều nhất và bump:</p>
<p><div class="not-prose">
<figure>
    <img src="https://hackmd.io/_uploads/S1d8Y1Sy6.png"
      alt="" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>Thật là quen :))) vậy tất cả đã rõ, bây giờ chỉ còn việc viết script để hoàn tất:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;CrazyArcade.sys&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">bytes</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">index</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x48\x89\x54\x24\x10</span><span class="s1">&#39;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;</span><span class="se">\xb7\x8a\x19\x7f</span><span class="s1">T-</span><span class="se">\x81\xf0\xb8\xdd\xca\xc9\xd3\xc3</span><span class="s1">#2</span><span class="se">\xba</span><span class="s1">A</span><span class="se">\x81\xab\x02</span><span class="s1">S</span><span class="se">\xc9</span><span class="s1">.</span><span class="se">\xd6</span><span class="s1">~ </span><span class="se">\xad\xab\xed\x95\xd2\xb6\xe7</span><span class="s1">*</span><span class="se">\x92</span><span class="s1">&gt;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">sth</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;./CrazyArcade.sys&#34;</span><span class="p">,</span> <span class="s2">&#34;rb&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">sth</span> <span class="o">=</span> <span class="n">sth</span><span class="p">[</span><span class="mh">0x850</span><span class="p">:]</span>
</span></span><span class="line"><span class="cl"><span class="n">r8d</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sth</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">37</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">flag</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^=</span> <span class="p">(</span><span class="n">r8d</span> <span class="o">^</span> <span class="n">sth</span><span class="p">[</span><span class="n">r8d</span> <span class="o">%</span> <span class="mh">0x584</span><span class="p">])</span><span class="o">&amp;</span><span class="mh">0xff</span>
</span></span><span class="line"><span class="cl">        <span class="n">r8d</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="sa">b</span><span class="s1">&#39;hitcon{&#39;</span> <span class="ow">in</span> <span class="n">flag</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="the-blade-rust">The-blade (Rust)</h2>
<p><em>Đây là một chương trình được viết bằng rust - một ngôn ngữ khá trầm cảm khi rev. Nếu cho mình xếp độ khó thì mình chọn bài này khó nhất và hay nhất, bởi mình đã mất rất nhiều ngày để hoàn thành được nó, mặc dù sau giải :(((</em></p>
<p>Không như những bài khác, đối với bài này, mình không làm tà đạo bằng cách mở thẳng IDA và chạy ngay, thay vào đó sẽ mở xem thử chương trình chạy thế nào. <del>Bởi có mở IDA liền thì cũng chả xác định được gì ngoài một núi hàm :))</del></p>
<p>Đây là những gì ta nhận được khi bắt đầu chạy chương trình:</p>
<p><div class="not-prose">
<figure>
    <img src="https://hackmd.io/_uploads/BJLQmxzlp.png"
      alt="" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>Tiếp đến, ta sẽ thử hết những lệnh ở đây, thấy được chỉ có mỗi <code>server</code> là thứ có vẻ ta nên tập trung vào.</p>
<p><div class="not-prose">
<figure>
    <img src="https://hackmd.io/_uploads/SJY_meMxT.png"
      alt="" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>Khi chạy server ta sẽ nhận được kết nối đến client(ở localhost).</p>
<p><div class="not-prose">
<figure>
    <img src="https://hackmd.io/_uploads/r1eUEgGgp.png"
      alt="" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>Ở đây, thấy được rằng có một đoạn shellcode được hiện ra ở server, ngoài ra khi có được shell thì ta chẳng thấy được điều gì khác nữa. Vậy câu hỏi đặt ra đó là flag ở đâu ?? làm gì để check flag khi có shell ??</p>
<p>Thử tất cả các cách từ debug đến dò từng hàm, vẫn không thấy bất cứ điều gì, sau cùng mình chỉ còn cách nghĩ đến <code>strings</code> nguyên file này thử xem có flag hay không. Điều này có vẻ khá ngớ ngẫn đối với các giải lớn nhưng vẫn cứ thử thôi. Và đây là thứ mình đã có được:</p>
<p><div class="not-prose">
<figure>
    <img src="https://hackmd.io/_uploads/H13VwxMg6.png"
      alt="" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>Mở IDA kiểm tra xem có gì ở đó không. Cứ theo hàm main ta sẽ thấy được một hàm như sau:</p>
<p><div class="not-prose">
<figure>
    <img src="https://hackmd.io/_uploads/HJWA9gzl6.png"
      alt="" 
      loading="lazy"
    >
  </figure></div>
</p>
<blockquote>
<p>Tại sao ở đây có rất nhiều hàm nhưng mình chỉ focus vào cái này? Đó là bởi nếu đọc kỹ comment ta sẽ phần nào đoán được đoạn code này đang promt gì đó với shell, còn các hàm kia chỉ promt, print, display, color, &hellip; trên server nên Không có gì đáng để quan tâm các hàm này.</p>
</blockquote>
<p>Tiếp tục, cứ xem thử từng hàm thì ta sẽ thấy được một hàm rất khả nghi có tên <code>verify</code>. Nó khả nghi là bởi tất cả các hàm khác chỉ convert, up file, netcat,&hellip;(có thể để ý thêm tất cả các này đều hiển thị khi netcat thành công). Và hàm này có thể đoán được nó đang check flag, bởi một phần vì tên của nó, một phần vì nó không liên quan gì tới những thứ hiển thị khi ta có được shell.</p>
<p><div class="not-prose">
<figure>
    <img src="https://hackmd.io/_uploads/Byee1bzep.png"
      alt="" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>Đây chính là hàm checkflag:</p>
<p><div class="not-prose">
<figure>
    <img src="https://hackmd.io/_uploads/Hy8lfZMga.png"
      alt="" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>Kết hợp với dò từng hàm cũng như nhận thấy hàm checkflag, ta có thể rút ra được vài kết quả như sau: Chương trình chạy server bằng <code>server -&gt; run -&gt; nc</code>, sau đó sẽ check flag bằng lệnh <code>flag hitcon{...}</code>(với chiều dài flag là 64).</p>
<p>Sau khi xác định được tất cả những thứ đó, bây giờ ta sẽ tập trung vào hàm check này.</p>
<p><div class="not-prose">
<figure>
    <img src="https://hackmd.io/_uploads/HJGvtpGx6.png"
      alt="" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>Nhìn vào đoạn code, có rất nhiều <code>do while</code> ở đây, theo mình đã tiếp xúc, đối với những đoạn như này nếu thuật toán ngắn (đoạn code ngắn) như bài ở DucCTF(transform) thì mình có thể dịch lại và code lại để có thể dễ debug. Còn nếu đoạn code dài như ở bài này thì ta có thể đoán như bài ở giải SEKAI(Sahuang flag checker), đó là mỗi <code>do while</code> nó chia flag ra thành từng phần để tính toán và thao tác.</p>
<p>Như đã nói ở trên, ta sẽ đi từng phần. Đầu tiên, thấy được rất nhiều đoạn code khá giống nhau. Chúng thực hiện memcpy và sau đó swap một thứ gì đó. Để xem hoàn toàn nó thực sự đang làm gì ở đây mình sẽ tiến hành debug, với 2 breakpoint được đặt tại đầu và cuối cùng của đoạn code giống nhau này.</p>
<p>Đầu tiên ta thấy được đoạn code sau:</p>
<p><div class="not-prose">
<figure>
    <img src="https://hackmd.io/_uploads/HyOFfCzep.png"
      alt="" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>Ở đây đoạn ASM này đang tiến hành load input vào và sau đó tiến hành thao tác trên input.</p>
<p>Sau khi chạy xong đoạn memcpy và đến <code>do while</code> tiếp theo thì đây là kết quả đã thu được:</p>
<p><div class="not-prose">
<figure>
    <img src="https://hackmd.io/_uploads/ryDV70zep.png"
      alt="" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>Ta cùng nhau nhìn lại một xíu về đoạn này. Với đầu vào được đưa vào đó là <code>flag abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/</code> và đầu ra <code>Rp5v+AZmM8XWy1sgNhTB/oCzYVdPrGn6KD3Q9lke4qtFxHb0uUOcS2jIEJfL7aiw</code>. Đầu vào và đầu ra đều có chiều dài như nhau, ta lại thử tiếp một lần với input toàn là <code>a</code> và đây là kết quả:</p>
<p><div class="not-prose">
<figure>
    <img src="https://hackmd.io/_uploads/BkMPEAMl6.png"
      alt="" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>Tiếp tục với <code>abcd</code>, ta cũng có được output như sau:</p>
<p><div class="not-prose">
<figure>
    <img src="https://hackmd.io/_uploads/S1gJr0zl6.png"
      alt="" 
      loading="lazy"
    >
  </figure></div>
</p>
<blockquote>
<p>Sở dĩ có thêm dấu <code>+/</code> là bởi có một hàm <code>memcpy(dest, &quot;/&quot;, 0x200uLL);</code> mình cũng không thực sự nó có tác dụng gì nên mình thêm vào luôn input.</p>
</blockquote>
<p>Vậy từ 3 kết quả trên ta thấy được <code>input[i]</code> đầu vào sẽ được map tương ứng với <code>input[j]</code> . Nên bây giờ ta sẽ lấy kết quả đầu tiên vì kết quả đầu tiên bao gồm <code>a...zA...Z0...9+\</code> hầu như đã có gần hết các ký tự có thể in được. Ta sẽ làm lại đoạn code map <code>do while</code> như sau:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">ip</span> <span class="o">=</span> <span class="s2">&#34;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">resmap</span> <span class="o">=</span> <span class="s2">&#34;Rp5v+AZmM8XWy1sgNhTB/oCzYVdPrGn6KD3Q9lke4qtFxHb0uUOcS2jIEJfL7aiw&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">mp</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">64</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">ch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ip</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">mp</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">resmap</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>
</span></span></code></pre></div><blockquote>
<p>Đoạn code trên đã làm lại đoạn map trong chương trình, có vẻ như nó giống với hoán vị hơn bởi mỗi vị trí ouput tương ứng chính là vị trí của đầu vào đã có.</p>
</blockquote>
<p>Để rev lại đoạn code này khá dễ chỉ cần làm ngược lại là xong.</p>
<p>Tiếp đến đoạn tiếp theo:</p>
<p><div class="not-prose">
<figure>
    <img src="https://hackmd.io/_uploads/B1FV5MQeT.png"
      alt="" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>Đoạn code này, trong quá trình debug có thể thấy được từ kết quả hoán vị của phần trên thì với mỗi ký tự sau khi hoán vị nó được map thành một output nhất định tương ứng. Lúc đầu nhìn thấy chỉ xor và cộng trừ nên mình đã thử viết lại nhưng đoạn <code>do</code> ở trên mình chưa nhìn được nó là gì nên mình chả viết lại để rev được.</p>
<p>Khi không hiểu rõ thuật toán chương trình mà cũng không thể code lại được thuật toán đó thì mình chỉ còn cách chạy thẳng chương trình lưu kết quả trước và sau khi thực hiện.</p>
<p>Đối với lần đầu tiên thì chương trình lấy kết quả đã hoán vị của input để map:</p>
<p><div class="not-prose">
<figure>
    <img src="https://hackmd.io/_uploads/HyIg6MXlT.png"
      alt="" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>Lần tiếp theo chạy nó lại tiếp tục load những bytes đã set sẵn để map:</p>
<p><div class="not-prose">
<figure>
    <img src="https://hackmd.io/_uploads/HJXETMXxT.png"
      alt="" 
      loading="lazy"
    >
  </figure></div>
</p>
<p><div class="not-prose">
<figure>
    <img src="https://hackmd.io/_uploads/HkGrTzmeT.png"
      alt="" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>Sau nhiều lần chạy với những input khác nhau, ta để ý mỗi ký tự sẽ được map với 1 số nhất định dù cho input có khác nhau đi nữa. Vậy bây giờ công việc của mình phải xem hết 256 bytes thì với mỗi bytes thì thuật toán map tương ứng với giá trị nào. Và đây là kết quả:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">valmap</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x52</span><span class="p">,</span> <span class="mh">0x70</span><span class="p">,</span> <span class="mh">0x35</span><span class="p">,</span> <span class="mh">0x76</span><span class="p">,</span> <span class="mh">0x2B</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span> <span class="mh">0x5A</span><span class="p">,</span> <span class="mh">0x6D</span><span class="p">,</span> <span class="mh">0x4D</span><span class="p">,</span> <span class="mh">0x38</span><span class="p">,</span> <span class="mh">0x58</span><span class="p">,</span> <span class="mh">0x57</span><span class="p">,</span> <span class="mh">0x79</span><span class="p">,</span> <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0x73</span><span class="p">,</span> <span class="mh">0x67</span><span class="p">,</span> <span class="mh">0x4E</span><span class="p">,</span> <span class="mh">0x68</span><span class="p">,</span> <span class="mh">0x54</span><span class="p">,</span> <span class="mh">0x42</span><span class="p">,</span> <span class="mh">0x2F</span><span class="p">,</span> <span class="mh">0x6F</span><span class="p">,</span> <span class="mh">0x43</span><span class="p">,</span> <span class="mh">0x7A</span><span class="p">,</span> <span class="mh">0x59</span><span class="p">,</span> <span class="mh">0x56</span><span class="p">,</span> <span class="mh">0x64</span><span class="p">,</span> <span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x72</span><span class="p">,</span> <span class="mh">0x47</span><span class="p">,</span> <span class="mh">0x6E</span><span class="p">,</span> <span class="mh">0x36</span><span class="p">,</span> <span class="mh">0x4B</span><span class="p">,</span> <span class="mh">0x44</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x51</span><span class="p">,</span> <span class="mh">0x39</span><span class="p">,</span> <span class="mh">0x6C</span><span class="p">,</span> <span class="mh">0x6B</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x34</span><span class="p">,</span> <span class="mh">0x71</span><span class="p">,</span> <span class="mh">0x74</span><span class="p">,</span> <span class="mh">0x46</span><span class="p">,</span> <span class="mh">0x78</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x62</span><span class="p">,</span> <span class="mh">0x30</span><span class="p">,</span> <span class="mh">0x75</span><span class="p">,</span> <span class="mh">0x55</span><span class="p">,</span> <span class="mh">0x4F</span><span class="p">,</span> <span class="mh">0x63</span><span class="p">,</span> <span class="mh">0x53</span><span class="p">,</span> <span class="mh">0x32</span><span class="p">,</span> <span class="mh">0x6A</span><span class="p">,</span> <span class="mh">0x49</span><span class="p">,</span> <span class="mh">0x45</span><span class="p">,</span> <span class="mh">0x4A</span><span class="p">,</span> <span class="mh">0x66</span><span class="p">,</span> <span class="mh">0x4C</span><span class="p">,</span> <span class="mh">0x37</span><span class="p">,</span> <span class="mh">0x61</span><span class="p">,</span> <span class="mh">0x69</span><span class="p">,</span> <span class="mh">0x77</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x06</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0x0C</span><span class="p">,</span> <span class="mh">0x0D</span><span class="p">,</span> <span class="mh">0x0E</span><span class="p">,</span> <span class="mh">0x0F</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> <span class="mh">0x09</span><span class="p">,</span> <span class="mh">0x0A</span><span class="p">,</span> <span class="mh">0x0B</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span> <span class="mh">0x15</span><span class="p">,</span> <span class="mh">0x16</span><span class="p">,</span> <span class="mh">0x17</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0x13</span><span class="p">,</span> <span class="mh">0x1C</span><span class="p">,</span> <span class="mh">0x1D</span><span class="p">,</span> <span class="mh">0x1E</span><span class="p">,</span> <span class="mh">0x1F</span><span class="p">,</span> <span class="mh">0x18</span><span class="p">,</span> <span class="mh">0x19</span><span class="p">,</span> <span class="mh">0x1A</span><span class="p">,</span> <span class="mh">0x1B</span><span class="p">,</span> <span class="mh">0x24</span><span class="p">,</span> <span class="mh">0x25</span><span class="p">,</span> <span class="mh">0x26</span><span class="p">,</span> <span class="mh">0x27</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x21</span><span class="p">,</span> <span class="mh">0x22</span><span class="p">,</span> <span class="mh">0x23</span><span class="p">,</span> <span class="mh">0x2D</span><span class="p">,</span> <span class="mh">0x2E</span><span class="p">,</span> <span class="mh">0x3A</span><span class="p">,</span> <span class="mh">0x3B</span><span class="p">,</span> <span class="mh">0x28</span><span class="p">,</span> <span class="mh">0x29</span><span class="p">,</span> <span class="mh">0x2A</span><span class="p">,</span> <span class="mh">0x2C</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0x5B</span><span class="p">,</span> <span class="mh">0x5C</span><span class="p">,</span> <span class="mh">0x5D</span><span class="p">,</span> <span class="mh">0x3C</span><span class="p">,</span> <span class="mh">0x3D</span><span class="p">,</span> <span class="mh">0x3E</span><span class="p">,</span> <span class="mh">0x3F</span><span class="p">,</span> <span class="mh">0x7C</span><span class="p">,</span> <span class="mh">0x7D</span><span class="p">,</span> <span class="mh">0x7E</span><span class="p">,</span> <span class="mh">0x7F</span><span class="p">,</span> <span class="mh">0x5E</span><span class="p">,</span> <span class="mh">0x5F</span><span class="p">,</span> <span class="mh">0x60</span><span class="p">,</span> <span class="mh">0x7B</span><span class="p">,</span> <span class="mh">0x84</span><span class="p">,</span> <span class="mh">0x85</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0x87</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0x81</span><span class="p">,</span> <span class="mh">0x82</span><span class="p">,</span> <span class="mh">0x83</span><span class="p">,</span> <span class="mh">0x8C</span><span class="p">,</span> <span class="mh">0x8D</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl"><span class="mh">0x8E</span><span class="p">,</span> <span class="mh">0x8F</span><span class="p">,</span> <span class="mh">0x88</span><span class="p">,</span> <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0x8A</span><span class="p">,</span> <span class="mh">0x8B</span><span class="p">,</span> <span class="mh">0x94</span><span class="p">,</span> <span class="mh">0x95</span><span class="p">,</span> <span class="mh">0x96</span><span class="p">,</span><span class="mh">0x97</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0x91</span><span class="p">,</span> <span class="mh">0x92</span><span class="p">,</span> <span class="mh">0x93</span><span class="p">,</span> <span class="mh">0x9C</span><span class="p">,</span> <span class="mh">0x9D</span><span class="p">,</span> <span class="mh">0x9E</span><span class="p">,</span> <span class="mh">0x9F</span><span class="p">,</span> <span class="mh">0x98</span><span class="p">,</span> <span class="mh">0x99</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl"><span class="mh">0x9A</span><span class="p">,</span> <span class="mh">0x9B</span><span class="p">,</span> <span class="mh">0xA4</span><span class="p">,</span> <span class="mh">0xA5</span><span class="p">,</span> <span class="mh">0xA6</span><span class="p">,</span> <span class="mh">0xA7</span><span class="p">,</span> <span class="mh">0xA0</span><span class="p">,</span> <span class="mh">0xA1</span><span class="p">,</span> <span class="mh">0xA2</span><span class="p">,</span> <span class="mh">0xA3</span><span class="p">,</span> <span class="mh">0xAC</span><span class="p">,</span> <span class="mh">0xAD</span><span class="p">,</span> <span class="mh">0xAE</span><span class="p">,</span> <span class="mh">0xAF</span><span class="p">,</span> <span class="mh">0xA8</span><span class="p">,</span> <span class="mh">0xA9</span><span class="p">,</span> <span class="mh">0xAA</span><span class="p">,</span> <span class="mh">0xAB</span><span class="p">,</span> <span class="mh">0xB4</span><span class="p">,</span> <span class="mh">0xB5</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl"><span class="mh">0xB6</span><span class="p">,</span> <span class="mh">0xB7</span><span class="p">,</span> <span class="mh">0xB0</span><span class="p">,</span> <span class="mh">0xB1</span><span class="p">,</span> <span class="mh">0xB2</span><span class="p">,</span> <span class="mh">0xB3</span><span class="p">,</span> <span class="mh">0xBC</span><span class="p">,</span> <span class="mh">0xBD</span><span class="p">,</span> <span class="mh">0xBE</span><span class="p">,</span> <span class="mh">0xBF</span><span class="p">,</span> <span class="mh">0xB8</span><span class="p">,</span> <span class="mh">0xB9</span><span class="p">,</span> <span class="mh">0xBA</span><span class="p">,</span> <span class="mh">0xBB</span><span class="p">,</span> <span class="mh">0xC4</span><span class="p">,</span> <span class="mh">0xC5</span><span class="p">,</span> <span class="mh">0xC6</span><span class="p">,</span> <span class="mh">0xC7</span><span class="p">,</span> <span class="mh">0xC0</span><span class="p">,</span> <span class="mh">0xC1</span><span class="p">,</span> <span class="mh">0xC2</span><span class="p">,</span> <span class="mh">0xC3</span><span class="p">,</span> <span class="mh">0xCC</span><span class="p">,</span> <span class="mh">0xCD</span><span class="p">,</span> <span class="mh">0xCE</span><span class="p">,</span> <span class="mh">0xCF</span><span class="p">,</span> <span class="mh">0xC8</span><span class="p">,</span> <span class="mh">0xC9</span><span class="p">,</span> <span class="mh">0xCA</span><span class="p">,</span> <span class="mh">0xCB</span><span class="p">,</span> <span class="mh">0xD4</span><span class="p">,</span> <span class="mh">0xD5</span><span class="p">,</span> <span class="mh">0xD6</span><span class="p">,</span> <span class="mh">0xD7</span><span class="p">,</span> <span class="mh">0xD0</span><span class="p">,</span> <span class="mh">0xD1</span><span class="p">,</span> <span class="mh">0xD2</span><span class="p">,</span> <span class="mh">0xD3</span><span class="p">,</span> <span class="mh">0xDC</span><span class="p">,</span> <span class="mh">0xDD</span><span class="p">,</span> <span class="mh">0xDE</span><span class="p">,</span> <span class="mh">0xDF</span><span class="p">,</span> <span class="mh">0xD8</span><span class="p">,</span> <span class="mh">0xD9</span><span class="p">,</span> <span class="mh">0xDA</span><span class="p">,</span> <span class="mh">0xDB</span><span class="p">,</span> <span class="mh">0xE4</span><span class="p">,</span> <span class="mh">0xE5</span><span class="p">,</span> <span class="mh">0xE6</span><span class="p">,</span> <span class="mh">0xE7</span><span class="p">,</span> <span class="mh">0xE0</span><span class="p">,</span> <span class="mh">0xE1</span><span class="p">,</span> <span class="mh">0xE2</span><span class="p">,</span> <span class="mh">0xE3</span><span class="p">,</span> <span class="mh">0xEC</span><span class="p">,</span> <span class="mh">0xED</span><span class="p">,</span> <span class="mh">0xEE</span><span class="p">,</span> <span class="mh">0xEF</span><span class="p">,</span> <span class="mh">0xE8</span><span class="p">,</span> <span class="mh">0xE9</span><span class="p">,</span> <span class="mh">0xEA</span><span class="p">,</span> <span class="mh">0xEB</span><span class="p">,</span> <span class="mh">0xF4</span><span class="p">,</span> <span class="mh">0xF5</span><span class="p">,</span> <span class="mh">0xF6</span><span class="p">,</span> <span class="mh">0xF7</span><span class="p">,</span> <span class="mh">0xF0</span><span class="p">,</span> <span class="mh">0xF1</span><span class="p">,</span> <span class="mh">0xF2</span><span class="p">,</span> <span class="mh">0xF3</span><span class="p">,</span> <span class="mh">0xFC</span><span class="p">,</span> <span class="mh">0xFD</span><span class="p">,</span> <span class="mh">0xFE</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xF8</span><span class="p">,</span> <span class="mh">0xF9</span><span class="p">,</span> <span class="mh">0xFA</span><span class="p">,</span> <span class="mh">0xFB</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">resmap</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x58</span><span class="p">,</span> <span class="mh">0x6C</span><span class="p">,</span> <span class="mh">0x61</span><span class="p">,</span> <span class="mh">0x2E</span><span class="p">,</span> <span class="mh">0x69</span><span class="p">,</span> <span class="mh">0x32</span><span class="p">,</span> <span class="mh">0xCB</span><span class="p">,</span> <span class="mh">0xE2</span><span class="p">,</span> <span class="mh">0xB3</span><span class="p">,</span> <span class="mh">0xE0</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0xA0</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0x1C</span><span class="p">,</span> <span class="mh">0x6B</span><span class="p">,</span> <span class="mh">0xC1</span><span class="p">,</span> <span class="mh">0xEC</span><span class="p">,</span> <span class="mh">0x9C</span><span class="p">,</span> <span class="mh">0x79</span><span class="p">,</span> <span class="mh">0xD2</span><span class="p">,</span> <span class="mh">0x9E</span><span class="p">,</span> <span class="mh">0xC2</span><span class="p">,</span> <span class="mh">0xD9</span><span class="p">,</span> <span class="mh">0x74</span><span class="p">,</span> <span class="mh">0x0C</span><span class="p">,</span> <span class="mh">0x3B</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="mh">0x9F</span><span class="p">,</span> <span class="mh">0x1E</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span> <span class="mh">0xED</span><span class="p">,</span> <span class="mh">0xA2</span><span class="p">,</span> <span class="mh">0x8F</span><span class="p">,</span> <span class="mh">0x97</span><span class="p">,</span> <span class="mh">0xCA</span><span class="p">,</span> <span class="mh">0xDA</span><span class="p">,</span> <span class="mh">0xD8</span><span class="p">,</span> <span class="mh">0xA4</span><span class="p">,</span> <span class="mh">0x39</span><span class="p">,</span> <span class="mh">0x5B</span><span class="p">,</span> <span class="mh">0x64</span><span class="p">,</span> <span class="mh">0x7E</span><span class="p">,</span> <span class="mh">0xAF</span><span class="p">,</span> <span class="mh">0x0B</span><span class="p">,</span> <span class="mh">0x93</span><span class="p">,</span> <span class="mh">0x71</span><span class="p">,</span> <span class="mh">0x0F</span><span class="p">,</span> <span class="mh">0x99</span><span class="p">,</span> <span class="mh">0xFD</span><span class="p">,</span> <span class="mh">0x81</span><span class="p">,</span> <span class="mh">0x0A</span><span class="p">,</span> <span class="mh">0xB7</span><span class="p">,</span> <span class="mh">0x66</span><span class="p">,</span> <span class="mh">0xEF</span><span class="p">,</span> <span class="mh">0x3A</span><span class="p">,</span> <span class="mh">0xEE</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xE1</span><span class="p">,</span> <span class="mh">0xAD</span><span class="p">,</span> <span class="mh">0x75</span><span class="p">,</span> <span class="mh">0xAB</span><span class="p">,</span> <span class="mh">0x09</span><span class="p">,</span> <span class="mh">0x51</span><span class="p">,</span> <span class="mh">0x15</span><span class="p">,</span> <span class="mh">0x8D</span><span class="p">,</span> <span class="mh">0xDB</span><span class="p">,</span> <span class="mh">0xFB</span><span class="p">,</span> <span class="mh">0x7B</span><span class="p">,</span> <span class="mh">0x4E</span><span class="p">,</span> <span class="mh">0xBB</span><span class="p">,</span> <span class="mh">0xAA</span><span class="p">,</span> <span class="mh">0xB2</span><span class="p">,</span> <span class="mh">0x60</span><span class="p">,</span> <span class="mh">0xEB</span><span class="p">,</span> <span class="mh">0xB0</span><span class="p">,</span> <span class="mh">0xAC</span><span class="p">,</span> <span class="mh">0xA5</span><span class="p">,</span> <span class="mh">0x8E</span><span class="p">,</span> <span class="mh">0x2B</span><span class="p">,</span> <span class="mh">0xC6</span><span class="p">,</span> <span class="mh">0xA6</span><span class="p">,</span> <span class="mh">0x35</span><span class="p">,</span> <span class="mh">0x63</span><span class="p">,</span> <span class="mh">0x5C</span><span class="p">,</span> <span class="mh">0xDE</span><span class="p">,</span> <span class="mh">0x42</span><span class="p">,</span> <span class="mh">0xBD</span><span class="p">,</span> <span class="mh">0x24</span><span class="p">,</span> <span class="mh">0xB1</span><span class="p">,</span> <span class="mh">0xE3</span><span class="p">,</span> <span class="mh">0x30</span><span class="p">,</span> <span class="mh">0x43</span><span class="p">,</span> <span class="mh">0xD6</span><span class="p">,</span> <span class="mh">0x5F</span><span class="p">,</span> <span class="mh">0x7C</span><span class="p">,</span> <span class="mh">0x6D</span><span class="p">,</span> <span class="mh">0x8B</span><span class="p">,</span> <span class="mh">0x17</span><span class="p">,</span> <span class="mh">0x8C</span><span class="p">,</span> <span class="mh">0xA7</span><span class="p">,</span> <span class="mh">0xD5</span><span class="p">,</span> <span class="mh">0x2A</span><span class="p">,</span> <span class="mh">0x59</span><span class="p">,</span> <span class="mh">0xA9</span><span class="p">,</span> <span class="mh">0x27</span><span class="p">,</span> <span class="mh">0x06</span><span class="p">,</span> <span class="mh">0x9D</span><span class="p">,</span> <span class="mh">0x83</span><span class="p">,</span> <span class="mh">0xFE</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span> <span class="mh">0xA8</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0xC0</span><span class="p">,</span> <span class="mh">0x25</span><span class="p">,</span> <span class="mh">0xDC</span><span class="p">,</span> <span class="mh">0x5E</span><span class="p">,</span> <span class="mh">0xE7</span><span class="p">,</span> <span class="mh">0xC4</span><span class="p">,</span> <span class="mh">0x2D</span><span class="p">,</span> <span class="mh">0x4F</span><span class="p">,</span> <span class="mh">0xF9</span><span class="p">,</span> <span class="mh">0x16</span><span class="p">,</span> <span class="mh">0x4D</span><span class="p">,</span> <span class="mh">0x2F</span><span class="p">,</span> <span class="mh">0x6A</span><span class="p">,</span> <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0x6F</span><span class="p">,</span> <span class="mh">0x5D</span><span class="p">,</span> <span class="mh">0xE8</span><span class="p">,</span> <span class="mh">0xFA</span><span class="p">,</span> <span class="mh">0x94</span><span class="p">,</span> <span class="mh">0xB6</span><span class="p">,</span> <span class="mh">0x1F</span><span class="p">,</span> <span class="mh">0x88</span><span class="p">,</span> <span class="mh">0xC5</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl"><span class="mh">0x7F</span><span class="p">,</span> <span class="mh">0x77</span><span class="p">,</span> <span class="mh">0xEA</span><span class="p">,</span> <span class="mh">0xB5</span><span class="p">,</span> <span class="mh">0x5A</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x3F</span><span class="p">,</span> <span class="mh">0xF4</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span><span class="mh">0x47</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span> <span class="mh">0xCF</span><span class="p">,</span> <span class="mh">0xF1</span><span class="p">,</span> <span class="mh">0x1B</span><span class="p">,</span> <span class="mh">0xE9</span><span class="p">,</span> <span class="mh">0x62</span><span class="p">,</span> <span class="mh">0x6E</span><span class="p">,</span> <span class="mh">0xB4</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0xE4</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl"><span class="mh">0xBA</span><span class="p">,</span> <span class="mh">0xDF</span><span class="p">,</span> <span class="mh">0x4B</span><span class="p">,</span> <span class="mh">0x28</span><span class="p">,</span> <span class="mh">0xD7</span><span class="p">,</span> <span class="mh">0xD1</span><span class="p">,</span> <span class="mh">0x96</span><span class="p">,</span> <span class="mh">0xCD</span><span class="p">,</span> <span class="mh">0x13</span><span class="p">,</span> <span class="mh">0x53</span><span class="p">,</span> <span class="mh">0x2C</span><span class="p">,</span> <span class="mh">0x9B</span><span class="p">,</span> <span class="mh">0x29</span><span class="p">,</span> <span class="mh">0x44</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0xB8</span><span class="p">,</span> <span class="mh">0xE6</span><span class="p">,</span> <span class="mh">0x7A</span><span class="p">,</span> <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0xD3</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl"><span class="mh">0xB9</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0x52</span><span class="p">,</span> <span class="mh">0xF7</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0xF2</span><span class="p">,</span> <span class="mh">0x1A</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0xA1</span><span class="p">,</span> <span class="mh">0x92</span><span class="p">,</span> <span class="mh">0xD0</span><span class="p">,</span> <span class="mh">0x34</span><span class="p">,</span> <span class="mh">0xF5</span><span class="p">,</span> <span class="mh">0x54</span><span class="p">,</span> <span class="mh">0xDD</span><span class="p">,</span> <span class="mh">0xBC</span><span class="p">,</span> <span class="mh">0x19</span><span class="p">,</span> <span class="mh">0xF3</span><span class="p">,</span> <span class="mh">0xFC</span><span class="p">,</span> <span class="mh">0x85</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">,</span> <span class="mh">0xBE</span><span class="p">,</span> <span class="mh">0x4C</span><span class="p">,</span> <span class="mh">0x7D</span><span class="p">,</span> <span class="mh">0xC7</span><span class="p">,</span> <span class="mh">0xD4</span><span class="p">,</span> <span class="mh">0x36</span><span class="p">,</span> <span class="mh">0xF6</span><span class="p">,</span> <span class="mh">0x72</span><span class="p">,</span> <span class="mh">0x98</span><span class="p">,</span> <span class="mh">0x8A</span><span class="p">,</span> <span class="mh">0xE5</span><span class="p">,</span> <span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x46</span><span class="p">,</span> <span class="mh">0x45</span><span class="p">,</span> <span class="mh">0x4A</span><span class="p">,</span> <span class="mh">0x9A</span><span class="p">,</span> <span class="mh">0xC3</span><span class="p">,</span> <span class="mh">0xC9</span><span class="p">,</span> <span class="mh">0x0E</span><span class="p">,</span> <span class="mh">0x3C</span><span class="p">,</span> <span class="mh">0x57</span><span class="p">,</span> <span class="mh">0xCC</span><span class="p">,</span> <span class="mh">0x68</span><span class="p">,</span> <span class="mh">0x76</span><span class="p">,</span> <span class="mh">0x67</span><span class="p">,</span> <span class="mh">0x84</span><span class="p">,</span> <span class="mh">0x0D</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0xA3</span><span class="p">,</span> <span class="mh">0xF0</span><span class="p">,</span> <span class="mh">0x22</span><span class="p">,</span> <span class="mh">0xBF</span><span class="p">,</span> <span class="mh">0x26</span><span class="p">,</span> <span class="mh">0x91</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x87</span><span class="p">,</span> <span class="mh">0x70</span><span class="p">,</span> <span class="mh">0xAE</span><span class="p">,</span> <span class="mh">0x3D</span><span class="p">,</span> <span class="mh">0x1D</span><span class="p">,</span> <span class="mh">0xC8</span><span class="p">,</span> <span class="mh">0x55</span><span class="p">,</span> <span class="mh">0x3E</span><span class="p">,</span> <span class="mh">0x37</span><span class="p">,</span> <span class="mh">0x23</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> <span class="mh">0x73</span><span class="p">,</span> <span class="mh">0x21</span><span class="p">,</span> <span class="mh">0x49</span><span class="p">,</span> <span class="mh">0x38</span><span class="p">,</span> <span class="mh">0x95</span><span class="p">,</span> <span class="mh">0x78</span><span class="p">,</span> <span class="mh">0xF8</span><span class="p">,</span> <span class="mh">0x18</span><span class="p">,</span> <span class="mh">0x56</span><span class="p">,</span> <span class="mh">0xCE</span><span class="p">,</span> <span class="mh">0x82</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">mp</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">256</span>
</span></span><span class="line"><span class="cl"><span class="n">rmp</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">256</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">valmap</span><span class="p">,</span> <span class="n">resmap</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">mp</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span>
</span></span></code></pre></div><blockquote>
<p>Ở đây, ta sẽ lợi dụng IDA để làm việc này, ta thấy được nội dung được lưu ở heap nên ta sẽ vào thẳng heap để chỉnh lại từng bytes sau đó lưu lại và chạy tiếp chương trình thì sẽ thu được kết quả tương ứng</p>
</blockquote>
<p><em>Sau khi xong được 2 phần trên, sau cùng là đoạn mình cho là hay nhất trong bài.</em></p>
<p>Cuối cùng là đoạn shellcode:</p>
<p><div class="not-prose">
<figure>
    <img src="https://hackmd.io/_uploads/BkewTEXea.png"
      alt="" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>Sở dĩ tại sao nhận ra được đây là đoạn shellcode là bởi debug thì ở client nhận được một đoạn bytes, ta chỉ việc lấy những bytes đó đưa về shellcode. Và đây là đoạn code thực hiện điều này:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">shellcode</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x54</span><span class="p">,</span> <span class="mh">0x5d</span><span class="p">,</span> <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0xf6</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0xb9</span><span class="p">,</span> <span class="mh">0xa1</span><span class="p">,</span> <span class="mh">0x57</span><span class="p">,</span> <span class="mh">0x06</span><span class="p">,</span> <span class="mh">0xb8</span><span class="p">,</span> <span class="mh">0x62</span><span class="p">,</span> <span class="mh">0x3a</span><span class="p">,</span> <span class="mh">0x9f</span><span class="p">,</span> <span class="mh">0x37</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0xba</span><span class="p">,</span> <span class="mh">0x8e</span><span class="p">,</span> <span class="mh">0x35</span><span class="p">,</span> <span class="mh">0x6f</span><span class="p">,</span> <span class="mh">0xd6</span><span class="p">,</span> <span class="mh">0x4d</span><span class="p">,</span> <span class="mh">0x49</span><span class="p">,</span> <span class="mh">0xf7</span><span class="p">,</span> <span class="mh">0x37</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0xd1</span><span class="p">,</span> <span class="mh">0x51</span><span class="p">,</span> <span class="mh">0x54</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x6a</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x58</span><span class="p">,</span> <span class="mh">0x99</span><span class="p">,</span> <span class="mh">0x0f</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x97</span><span class="p">,</span> <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0xc0</span><span class="p">,</span> <span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x54</span><span class="p">,</span> <span class="mh">0x5e</span><span class="p">,</span> <span class="mh">0x6a</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="mh">0x5a</span><span class="p">,</span> <span class="mh">0x0f</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span> <span class="mh">0x5c</span><span class="p">,</span> <span class="mh">0x6a</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0x58</span><span class="p">,</span> <span class="mh">0x0f</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0xf6</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0xb9</span><span class="p">,</span> <span class="mh">0x3b</span><span class="p">,</span> <span class="mh">0x3b</span><span class="p">,</span> <span class="mh">0x6f</span><span class="p">,</span> <span class="mh">0xc3</span><span class="p">,</span> <span class="mh">0x63</span><span class="p">,</span> <span class="mh">0x64</span><span class="p">,</span> <span class="mh">0xc0</span><span class="p">,</span> <span class="mh">0xaa</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0xba</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x4c</span><span class="p">,</span> <span class="mh">0x0b</span><span class="p">,</span> <span class="mh">0xc3</span><span class="p">,</span> <span class="mh">0x63</span><span class="p">,</span> <span class="mh">0x64</span><span class="p">,</span> <span class="mh">0xc0</span><span class="p">,</span> <span class="mh">0xaa</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0xd1</span><span class="p">,</span> <span class="mh">0x51</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0xb9</span><span class="p">,</span> <span class="mh">0x8c</span><span class="p">,</span> <span class="mh">0x57</span><span class="p">,</span> <span class="mh">0x82</span><span class="p">,</span> <span class="mh">0x75</span><span class="p">,</span> <span class="mh">0xd6</span><span class="p">,</span> <span class="mh">0xf8</span><span class="p">,</span> <span class="mh">0xa9</span><span class="p">,</span> <span class="mh">0x7d</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0xba</span><span class="p">,</span> <span class="mh">0xa3</span><span class="p">,</span> <span class="mh">0x32</span><span class="p">,</span> <span class="mh">0xf6</span><span class="p">,</span> <span class="mh">0x16</span><span class="p">,</span> <span class="mh">0xf9</span><span class="p">,</span> <span class="mh">0x88</span><span class="p">,</span> <span class="mh">0xc8</span><span class="p">,</span> <span class="mh">0x0e</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0xd1</span><span class="p">,</span> <span class="mh">0x51</span><span class="p">,</span> <span class="mh">0x54</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x6a</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x58</span><span class="p">,</span> <span class="mh">0x99</span><span class="p">,</span> <span class="mh">0x0f</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x97</span><span class="p">,</span> <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0xc0</span><span class="p">,</span> <span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x54</span><span class="p">,</span> <span class="mh">0x5e</span><span class="p">,</span> <span class="mh">0x6a</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="mh">0x5a</span><span class="p">,</span> <span class="mh">0x0f</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span> <span class="mh">0x5d</span><span class="p">,</span> <span class="mh">0x6a</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0x58</span><span class="p">,</span> <span class="mh">0x0f</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0xf6</span><span class="p">,</span> <span class="mh">0x6a</span><span class="p">,</span> <span class="mh">0x6f</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0xb9</span><span class="p">,</span> <span class="mh">0x59</span><span class="p">,</span> <span class="mh">0xe5</span><span class="p">,</span> <span class="mh">0x06</span><span class="p">,</span> <span class="mh">0x0c</span><span class="p">,</span> <span class="mh">0x2d</span><span class="p">,</span> <span class="mh">0xf6</span><span class="p">,</span> <span class="mh">0xd9</span><span class="p">,</span> <span class="mh">0x77</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0xba</span><span class="p">,</span> <span class="mh">0x76</span><span class="p">,</span> <span class="mh">0x81</span><span class="p">,</span> <span class="mh">0x63</span><span class="p">,</span> <span class="mh">0x7a</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x8c</span><span class="p">,</span> <span class="mh">0xbc</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0xd1</span><span class="p">,</span> <span class="mh">0x51</span><span class="p">,</span> <span class="mh">0x54</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x6a</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x58</span><span class="p">,</span> <span class="mh">0x99</span><span class="p">,</span> <span class="mh">0x0f</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x97</span><span class="p">,</span> <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0xc0</span><span class="p">,</span> <span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x54</span><span class="p">,</span> <span class="mh">0x5e</span><span class="p">,</span> <span class="mh">0x6a</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="mh">0x5a</span><span class="p">,</span> <span class="mh">0x0f</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x58</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0xf7</span><span class="p">,</span> <span class="mh">0xd0</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0xc1</span><span class="p">,</span> <span class="mh">0xe8</span><span class="p">,</span> <span class="mh">0x1d</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x99</span><span class="p">,</span> <span class="mh">0x6a</span><span class="p">,</span> <span class="mh">0x29</span><span class="p">,</span> <span class="mh">0x59</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0xf7</span><span class="p">,</span> <span class="mh">0xf1</span><span class="p">,</span> <span class="mh">0x49</span><span class="p">,</span> <span class="mh">0x96</span><span class="p">,</span> <span class="mh">0x6a</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0x58</span><span class="p">,</span> <span class="mh">0x0f</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0xb8</span><span class="p">,</span> <span class="mh">0xef</span><span class="p">,</span> <span class="mh">0xbe</span><span class="p">,</span> <span class="mh">0xad</span><span class="p">,</span> <span class="mh">0xde</span><span class="p">,</span> <span class="mh">0x44</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0xe0</span><span class="p">,</span> <span class="mh">0x44</span><span class="p">,</span> <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0xe8</span><span class="p">,</span> <span class="mh">0xc1</span><span class="p">,</span> <span class="mh">0xc8</span><span class="p">,</span> <span class="mh">0x0b</span><span class="p">,</span> <span class="mh">0xf7</span><span class="p">,</span> <span class="mh">0xd0</span><span class="p">,</span> <span class="mh">0x44</span><span class="p">,</span> <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0xf0</span><span class="p">,</span> <span class="mh">0x3d</span><span class="p">,</span> <span class="mh">0xef</span><span class="p">,</span> <span class="mh">0xbe</span><span class="p">,</span> <span class="mh">0xad</span><span class="p">,</span> <span class="mh">0xde</span><span class="p">,</span> <span class="mh">0x75</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x6a</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x58</span><span class="p">,</span> <span class="mh">0xeb</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0xc0</span><span class="p">,</span> <span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x53</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x54</span><span class="p">,</span> <span class="mh">0x5e</span><span class="p">,</span> <span class="mh">0x6a</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> <span class="mh">0x5a</span><span class="p">,</span> <span class="mh">0x6a</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x58</span><span class="p">,</span> <span class="mh">0x0f</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x55</span><span class="p">,</span> <span class="mh">0x5c</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xe7</span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">((</span><span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="p">)(</span><span class="kt">void</span><span class="p">))(</span><span class="n">shellcode</span><span class="p">))();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><blockquote>
<p>gcc main.c -z execstack -o main</p>
</blockquote>
<p>Sau khi có được binary của đoạn shellcode ta lại ném vào IDA:</p>
<p><div class="not-prose">
<figure>
    <img src="https://hackmd.io/_uploads/H1CHCNXeT.png"
      alt="" 
      loading="lazy"
    >
  </figure></div>
</p>
<p>Khi nhìn vào đoạn code này có vẻ như có một số điều khá thú vị ở đây. Đoạn code này đọc 4 bytes từ <code>/bin/sh</code> và <code>etc/passwd</code> sau đó tiếp tục đọc tại <code>/dev/zero</code> cuối cùng thực hiện các phép toán (các phép toán này có thể rev được). Vậy bây giờ ta cần xem xem 4 bytes ở đây là gồm những gì:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">FILE</span> <span class="o">*</span><span class="n">file</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">buffer</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">file</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="s">&#34;/dev/zero&#34;</span><span class="p">,</span> <span class="s">&#34;rb&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">file</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">printf</span><span class="p">(</span><span class="s">&#34;cant open.</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">fread</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="p">),</span> <span class="mi">4</span><span class="p">,</span> <span class="n">file</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;4 bytes /etc/passwd: %02x %02x %02x %02x</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">buffer</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">buffer</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">buffer</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">buffer</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">fclose</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><blockquote>
<p>Thay lần lượt những đường dẫn mình cần đọc</p>
</blockquote>
<p>Vậy từ đó ta đã có hết tất cả các giá trị. Cuối cùng rev chúng và kết hợp chúng lại. Đây là đoạn code để giải bài này:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">valMp</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x52</span><span class="p">,</span> <span class="mh">0x70</span><span class="p">,</span> <span class="mh">0x35</span><span class="p">,</span> <span class="mh">0x76</span><span class="p">,</span> <span class="mh">0x2B</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span> <span class="mh">0x5A</span><span class="p">,</span> <span class="mh">0x6D</span><span class="p">,</span> <span class="mh">0x4D</span><span class="p">,</span> <span class="mh">0x38</span><span class="p">,</span> <span class="mh">0x58</span><span class="p">,</span> <span class="mh">0x57</span><span class="p">,</span> <span class="mh">0x79</span><span class="p">,</span> <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0x73</span><span class="p">,</span> <span class="mh">0x67</span><span class="p">,</span> <span class="mh">0x4E</span><span class="p">,</span> <span class="mh">0x68</span><span class="p">,</span> <span class="mh">0x54</span><span class="p">,</span> <span class="mh">0x42</span><span class="p">,</span> <span class="mh">0x2F</span><span class="p">,</span> <span class="mh">0x6F</span><span class="p">,</span> <span class="mh">0x43</span><span class="p">,</span> <span class="mh">0x7A</span><span class="p">,</span> <span class="mh">0x59</span><span class="p">,</span> <span class="mh">0x56</span><span class="p">,</span> <span class="mh">0x64</span><span class="p">,</span> <span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x72</span><span class="p">,</span> <span class="mh">0x47</span><span class="p">,</span> <span class="mh">0x6E</span><span class="p">,</span> <span class="mh">0x36</span><span class="p">,</span> <span class="mh">0x4B</span><span class="p">,</span> <span class="mh">0x44</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x51</span><span class="p">,</span> <span class="mh">0x39</span><span class="p">,</span> <span class="mh">0x6C</span><span class="p">,</span> <span class="mh">0x6B</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x34</span><span class="p">,</span> <span class="mh">0x71</span><span class="p">,</span> <span class="mh">0x74</span><span class="p">,</span> <span class="mh">0x46</span><span class="p">,</span> <span class="mh">0x78</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x62</span><span class="p">,</span> <span class="mh">0x30</span><span class="p">,</span> <span class="mh">0x75</span><span class="p">,</span> <span class="mh">0x55</span><span class="p">,</span> <span class="mh">0x4F</span><span class="p">,</span> <span class="mh">0x63</span><span class="p">,</span> <span class="mh">0x53</span><span class="p">,</span> <span class="mh">0x32</span><span class="p">,</span> <span class="mh">0x6A</span><span class="p">,</span> <span class="mh">0x49</span><span class="p">,</span> <span class="mh">0x45</span><span class="p">,</span> <span class="mh">0x4A</span><span class="p">,</span> <span class="mh">0x66</span><span class="p">,</span> <span class="mh">0x4C</span><span class="p">,</span> <span class="mh">0x37</span><span class="p">,</span> <span class="mh">0x61</span><span class="p">,</span> <span class="mh">0x69</span><span class="p">,</span> <span class="mh">0x77</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x06</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0x0C</span><span class="p">,</span> <span class="mh">0x0D</span><span class="p">,</span> <span class="mh">0x0E</span><span class="p">,</span> <span class="mh">0x0F</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> <span class="mh">0x09</span><span class="p">,</span> <span class="mh">0x0A</span><span class="p">,</span> <span class="mh">0x0B</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span> <span class="mh">0x15</span><span class="p">,</span> <span class="mh">0x16</span><span class="p">,</span> <span class="mh">0x17</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0x13</span><span class="p">,</span> <span class="mh">0x1C</span><span class="p">,</span> <span class="mh">0x1D</span><span class="p">,</span> <span class="mh">0x1E</span><span class="p">,</span> <span class="mh">0x1F</span><span class="p">,</span> <span class="mh">0x18</span><span class="p">,</span> <span class="mh">0x19</span><span class="p">,</span> <span class="mh">0x1A</span><span class="p">,</span> <span class="mh">0x1B</span><span class="p">,</span> <span class="mh">0x24</span><span class="p">,</span> <span class="mh">0x25</span><span class="p">,</span> <span class="mh">0x26</span><span class="p">,</span> <span class="mh">0x27</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x21</span><span class="p">,</span> <span class="mh">0x22</span><span class="p">,</span> <span class="mh">0x23</span><span class="p">,</span> <span class="mh">0x2D</span><span class="p">,</span> <span class="mh">0x2E</span><span class="p">,</span> <span class="mh">0x3A</span><span class="p">,</span> <span class="mh">0x3B</span><span class="p">,</span> <span class="mh">0x28</span><span class="p">,</span> <span class="mh">0x29</span><span class="p">,</span> <span class="mh">0x2A</span><span class="p">,</span> <span class="mh">0x2C</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0x5B</span><span class="p">,</span> <span class="mh">0x5C</span><span class="p">,</span> <span class="mh">0x5D</span><span class="p">,</span> <span class="mh">0x3C</span><span class="p">,</span> <span class="mh">0x3D</span><span class="p">,</span> <span class="mh">0x3E</span><span class="p">,</span> <span class="mh">0x3F</span><span class="p">,</span> <span class="mh">0x7C</span><span class="p">,</span> <span class="mh">0x7D</span><span class="p">,</span> <span class="mh">0x7E</span><span class="p">,</span> <span class="mh">0x7F</span><span class="p">,</span> <span class="mh">0x5E</span><span class="p">,</span> <span class="mh">0x5F</span><span class="p">,</span> <span class="mh">0x60</span><span class="p">,</span> <span class="mh">0x7B</span><span class="p">,</span> <span class="mh">0x84</span><span class="p">,</span> <span class="mh">0x85</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0x87</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0x81</span><span class="p">,</span> <span class="mh">0x82</span><span class="p">,</span> <span class="mh">0x83</span><span class="p">,</span> <span class="mh">0x8C</span><span class="p">,</span> <span class="mh">0x8D</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl"><span class="mh">0x8E</span><span class="p">,</span> <span class="mh">0x8F</span><span class="p">,</span> <span class="mh">0x88</span><span class="p">,</span> <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0x8A</span><span class="p">,</span> <span class="mh">0x8B</span><span class="p">,</span> <span class="mh">0x94</span><span class="p">,</span> <span class="mh">0x95</span><span class="p">,</span> <span class="mh">0x96</span><span class="p">,</span> <span class="mh">0x97</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0x91</span><span class="p">,</span> <span class="mh">0x92</span><span class="p">,</span> <span class="mh">0x93</span><span class="p">,</span> <span class="mh">0x9C</span><span class="p">,</span> <span class="mh">0x9D</span><span class="p">,</span> <span class="mh">0x9E</span><span class="p">,</span> <span class="mh">0x9F</span><span class="p">,</span> <span class="mh">0x98</span><span class="p">,</span> <span class="mh">0x99</span><span class="p">,</span> <span class="mh">0x9A</span><span class="p">,</span> <span class="mh">0x9B</span><span class="p">,</span> <span class="mh">0xA4</span><span class="p">,</span> <span class="mh">0xA5</span><span class="p">,</span> <span class="mh">0xA6</span><span class="p">,</span> <span class="mh">0xA7</span><span class="p">,</span> <span class="mh">0xA0</span><span class="p">,</span> <span class="mh">0xA1</span><span class="p">,</span> <span class="mh">0xA2</span><span class="p">,</span> <span class="mh">0xA3</span><span class="p">,</span> <span class="mh">0xAC</span><span class="p">,</span> <span class="mh">0xAD</span><span class="p">,</span> <span class="mh">0xAE</span><span class="p">,</span> <span class="mh">0xAF</span><span class="p">,</span> <span class="mh">0xA8</span><span class="p">,</span> <span class="mh">0xA9</span><span class="p">,</span> <span class="mh">0xAA</span><span class="p">,</span> <span class="mh">0xAB</span><span class="p">,</span> <span class="mh">0xB4</span><span class="p">,</span> <span class="mh">0xB5</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl"><span class="mh">0xB6</span><span class="p">,</span> <span class="mh">0xB7</span><span class="p">,</span> <span class="mh">0xB0</span><span class="p">,</span> <span class="mh">0xB1</span><span class="p">,</span> <span class="mh">0xB2</span><span class="p">,</span> <span class="mh">0xB3</span><span class="p">,</span> <span class="mh">0xBC</span><span class="p">,</span> <span class="mh">0xBD</span><span class="p">,</span> <span class="mh">0xBE</span><span class="p">,</span> <span class="mh">0xBF</span><span class="p">,</span> <span class="mh">0xB8</span><span class="p">,</span> <span class="mh">0xB9</span><span class="p">,</span> <span class="mh">0xBA</span><span class="p">,</span> <span class="mh">0xBB</span><span class="p">,</span> <span class="mh">0xC4</span><span class="p">,</span> <span class="mh">0xC5</span><span class="p">,</span> <span class="mh">0xC6</span><span class="p">,</span> <span class="mh">0xC7</span><span class="p">,</span> <span class="mh">0xC0</span><span class="p">,</span> <span class="mh">0xC1</span><span class="p">,</span> <span class="mh">0xC2</span><span class="p">,</span> <span class="mh">0xC3</span><span class="p">,</span> <span class="mh">0xCC</span><span class="p">,</span> <span class="mh">0xCD</span><span class="p">,</span> <span class="mh">0xCE</span><span class="p">,</span> <span class="mh">0xCF</span><span class="p">,</span> <span class="mh">0xC8</span><span class="p">,</span> <span class="mh">0xC9</span><span class="p">,</span> <span class="mh">0xCA</span><span class="p">,</span> <span class="mh">0xCB</span><span class="p">,</span> <span class="mh">0xD4</span><span class="p">,</span> <span class="mh">0xD5</span><span class="p">,</span> <span class="mh">0xD6</span><span class="p">,</span> <span class="mh">0xD7</span><span class="p">,</span> <span class="mh">0xD0</span><span class="p">,</span> <span class="mh">0xD1</span><span class="p">,</span> <span class="mh">0xD2</span><span class="p">,</span> <span class="mh">0xD3</span><span class="p">,</span> <span class="mh">0xDC</span><span class="p">,</span> <span class="mh">0xDD</span><span class="p">,</span> <span class="mh">0xDE</span><span class="p">,</span> <span class="mh">0xDF</span><span class="p">,</span> <span class="mh">0xD8</span><span class="p">,</span> <span class="mh">0xD9</span><span class="p">,</span> <span class="mh">0xDA</span><span class="p">,</span> <span class="mh">0xDB</span><span class="p">,</span> <span class="mh">0xE4</span><span class="p">,</span> <span class="mh">0xE5</span><span class="p">,</span> <span class="mh">0xE6</span><span class="p">,</span> <span class="mh">0xE7</span><span class="p">,</span> <span class="mh">0xE0</span><span class="p">,</span> <span class="mh">0xE1</span><span class="p">,</span> <span class="mh">0xE2</span><span class="p">,</span> <span class="mh">0xE3</span><span class="p">,</span> <span class="mh">0xEC</span><span class="p">,</span> <span class="mh">0xED</span><span class="p">,</span> <span class="mh">0xEE</span><span class="p">,</span> <span class="mh">0xEF</span><span class="p">,</span> <span class="mh">0xE8</span><span class="p">,</span> <span class="mh">0xE9</span><span class="p">,</span> <span class="mh">0xEA</span><span class="p">,</span> <span class="mh">0xEB</span><span class="p">,</span> <span class="mh">0xF4</span><span class="p">,</span> <span class="mh">0xF5</span><span class="p">,</span> <span class="mh">0xF6</span><span class="p">,</span> <span class="mh">0xF7</span><span class="p">,</span> <span class="mh">0xF0</span><span class="p">,</span> <span class="mh">0xF1</span><span class="p">,</span> <span class="mh">0xF2</span><span class="p">,</span> <span class="mh">0xF3</span><span class="p">,</span> <span class="mh">0xFC</span><span class="p">,</span> <span class="mh">0xFD</span><span class="p">,</span> <span class="mh">0xFE</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xF8</span><span class="p">,</span> <span class="mh">0xF9</span><span class="p">,</span> <span class="mh">0xFA</span><span class="p">,</span> <span class="mh">0xFB</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">resMp</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x58</span><span class="p">,</span> <span class="mh">0x6C</span><span class="p">,</span> <span class="mh">0x61</span><span class="p">,</span> <span class="mh">0x2E</span><span class="p">,</span> <span class="mh">0x69</span><span class="p">,</span> <span class="mh">0x32</span><span class="p">,</span> <span class="mh">0xCB</span><span class="p">,</span> <span class="mh">0xE2</span><span class="p">,</span> <span class="mh">0xB3</span><span class="p">,</span> <span class="mh">0xE0</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0xA0</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0x1C</span><span class="p">,</span> <span class="mh">0x6B</span><span class="p">,</span> <span class="mh">0xC1</span><span class="p">,</span> <span class="mh">0xEC</span><span class="p">,</span> <span class="mh">0x9C</span><span class="p">,</span> <span class="mh">0x79</span><span class="p">,</span> <span class="mh">0xD2</span><span class="p">,</span> <span class="mh">0x9E</span><span class="p">,</span> <span class="mh">0xC2</span><span class="p">,</span> <span class="mh">0xD9</span><span class="p">,</span> <span class="mh">0x74</span><span class="p">,</span> <span class="mh">0x0C</span><span class="p">,</span> <span class="mh">0x3B</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="mh">0x9F</span><span class="p">,</span> <span class="mh">0x1E</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span> <span class="mh">0xED</span><span class="p">,</span> <span class="mh">0xA2</span><span class="p">,</span> <span class="mh">0x8F</span><span class="p">,</span> <span class="mh">0x97</span><span class="p">,</span> <span class="mh">0xCA</span><span class="p">,</span> <span class="mh">0xDA</span><span class="p">,</span> <span class="mh">0xD8</span><span class="p">,</span> <span class="mh">0xA4</span><span class="p">,</span> <span class="mh">0x39</span><span class="p">,</span> <span class="mh">0x5B</span><span class="p">,</span> <span class="mh">0x64</span><span class="p">,</span> <span class="mh">0x7E</span><span class="p">,</span> <span class="mh">0xAF</span><span class="p">,</span> <span class="mh">0x0B</span><span class="p">,</span> <span class="mh">0x93</span><span class="p">,</span> <span class="mh">0x71</span><span class="p">,</span> <span class="mh">0x0F</span><span class="p">,</span> <span class="mh">0x99</span><span class="p">,</span> <span class="mh">0xFD</span><span class="p">,</span> <span class="mh">0x81</span><span class="p">,</span> <span class="mh">0x0A</span><span class="p">,</span> <span class="mh">0xB7</span><span class="p">,</span> <span class="mh">0x66</span><span class="p">,</span> <span class="mh">0xEF</span><span class="p">,</span> <span class="mh">0x3A</span><span class="p">,</span> <span class="mh">0xEE</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xE1</span><span class="p">,</span> <span class="mh">0xAD</span><span class="p">,</span> <span class="mh">0x75</span><span class="p">,</span> <span class="mh">0xAB</span><span class="p">,</span> <span class="mh">0x09</span><span class="p">,</span> <span class="mh">0x51</span><span class="p">,</span> <span class="mh">0x15</span><span class="p">,</span> <span class="mh">0x8D</span><span class="p">,</span> <span class="mh">0xDB</span><span class="p">,</span> <span class="mh">0xFB</span><span class="p">,</span> <span class="mh">0x7B</span><span class="p">,</span> <span class="mh">0x4E</span><span class="p">,</span> <span class="mh">0xBB</span><span class="p">,</span> <span class="mh">0xAA</span><span class="p">,</span> <span class="mh">0xB2</span><span class="p">,</span> <span class="mh">0x60</span><span class="p">,</span> <span class="mh">0xEB</span><span class="p">,</span> <span class="mh">0xB0</span><span class="p">,</span> <span class="mh">0xAC</span><span class="p">,</span> <span class="mh">0xA5</span><span class="p">,</span> <span class="mh">0x8E</span><span class="p">,</span> <span class="mh">0x2B</span><span class="p">,</span> <span class="mh">0xC6</span><span class="p">,</span> <span class="mh">0xA6</span><span class="p">,</span> <span class="mh">0x35</span><span class="p">,</span> <span class="mh">0x63</span><span class="p">,</span> <span class="mh">0x5C</span><span class="p">,</span> <span class="mh">0xDE</span><span class="p">,</span> <span class="mh">0x42</span><span class="p">,</span> <span class="mh">0xBD</span><span class="p">,</span> <span class="mh">0x24</span><span class="p">,</span> <span class="mh">0xB1</span><span class="p">,</span> <span class="mh">0xE3</span><span class="p">,</span> <span class="mh">0x30</span><span class="p">,</span> <span class="mh">0x43</span><span class="p">,</span> <span class="mh">0xD6</span><span class="p">,</span> <span class="mh">0x5F</span><span class="p">,</span> <span class="mh">0x7C</span><span class="p">,</span> <span class="mh">0x6D</span><span class="p">,</span> <span class="mh">0x8B</span><span class="p">,</span> <span class="mh">0x17</span><span class="p">,</span> <span class="mh">0x8C</span><span class="p">,</span> <span class="mh">0xA7</span><span class="p">,</span> <span class="mh">0xD5</span><span class="p">,</span> <span class="mh">0x2A</span><span class="p">,</span> <span class="mh">0x59</span><span class="p">,</span> <span class="mh">0xA9</span><span class="p">,</span> <span class="mh">0x27</span><span class="p">,</span> <span class="mh">0x06</span><span class="p">,</span> <span class="mh">0x9D</span><span class="p">,</span> <span class="mh">0x83</span><span class="p">,</span> <span class="mh">0xFE</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span> <span class="mh">0xA8</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0xC0</span><span class="p">,</span> <span class="mh">0x25</span><span class="p">,</span> <span class="mh">0xDC</span><span class="p">,</span> <span class="mh">0x5E</span><span class="p">,</span> <span class="mh">0xE7</span><span class="p">,</span> <span class="mh">0xC4</span><span class="p">,</span> <span class="mh">0x2D</span><span class="p">,</span> <span class="mh">0x4F</span><span class="p">,</span> <span class="mh">0xF9</span><span class="p">,</span> <span class="mh">0x16</span><span class="p">,</span> <span class="mh">0x4D</span><span class="p">,</span> <span class="mh">0x2F</span><span class="p">,</span> <span class="mh">0x6A</span><span class="p">,</span> <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0x6F</span><span class="p">,</span> <span class="mh">0x5D</span><span class="p">,</span> <span class="mh">0xE8</span><span class="p">,</span> <span class="mh">0xFA</span><span class="p">,</span> <span class="mh">0x94</span><span class="p">,</span> <span class="mh">0xB6</span><span class="p">,</span> <span class="mh">0x1F</span><span class="p">,</span> <span class="mh">0x88</span><span class="p">,</span> <span class="mh">0xC5</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl"><span class="mh">0x7F</span><span class="p">,</span> <span class="mh">0x77</span><span class="p">,</span> <span class="mh">0xEA</span><span class="p">,</span> <span class="mh">0xB5</span><span class="p">,</span> <span class="mh">0x5A</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x3F</span><span class="p">,</span> <span class="mh">0xF4</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x47</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span> <span class="mh">0xCF</span><span class="p">,</span> <span class="mh">0xF1</span><span class="p">,</span> <span class="mh">0x1B</span><span class="p">,</span> <span class="mh">0xE9</span><span class="p">,</span> <span class="mh">0x62</span><span class="p">,</span> <span class="mh">0x6E</span><span class="p">,</span> <span class="mh">0xB4</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0xE4</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl"><span class="mh">0xBA</span><span class="p">,</span> <span class="mh">0xDF</span><span class="p">,</span> <span class="mh">0x4B</span><span class="p">,</span> <span class="mh">0x28</span><span class="p">,</span> <span class="mh">0xD7</span><span class="p">,</span> <span class="mh">0xD1</span><span class="p">,</span> <span class="mh">0x96</span><span class="p">,</span> <span class="mh">0xCD</span><span class="p">,</span> <span class="mh">0x13</span><span class="p">,</span> <span class="mh">0x53</span><span class="p">,</span> <span class="mh">0x2C</span><span class="p">,</span> <span class="mh">0x9B</span><span class="p">,</span> <span class="mh">0x29</span><span class="p">,</span> <span class="mh">0x44</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0xB8</span><span class="p">,</span> <span class="mh">0xE6</span><span class="p">,</span> <span class="mh">0x7A</span><span class="p">,</span> <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0xD3</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl"><span class="mh">0xB9</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0x52</span><span class="p">,</span> <span class="mh">0xF7</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0xF2</span><span class="p">,</span> <span class="mh">0x1A</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0xA1</span><span class="p">,</span> <span class="mh">0x92</span><span class="p">,</span> <span class="mh">0xD0</span><span class="p">,</span> <span class="mh">0x34</span><span class="p">,</span> <span class="mh">0xF5</span><span class="p">,</span> <span class="mh">0x54</span><span class="p">,</span> <span class="mh">0xDD</span><span class="p">,</span> <span class="mh">0xBC</span><span class="p">,</span> <span class="mh">0x19</span><span class="p">,</span> <span class="mh">0xF3</span><span class="p">,</span> <span class="mh">0xFC</span><span class="p">,</span> <span class="mh">0x85</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">,</span> <span class="mh">0xBE</span><span class="p">,</span> <span class="mh">0x4C</span><span class="p">,</span> <span class="mh">0x7D</span><span class="p">,</span> <span class="mh">0xC7</span><span class="p">,</span> <span class="mh">0xD4</span><span class="p">,</span> <span class="mh">0x36</span><span class="p">,</span> <span class="mh">0xF6</span><span class="p">,</span> <span class="mh">0x72</span><span class="p">,</span> <span class="mh">0x98</span><span class="p">,</span> <span class="mh">0x8A</span><span class="p">,</span> <span class="mh">0xE5</span><span class="p">,</span> <span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x46</span><span class="p">,</span> <span class="mh">0x45</span><span class="p">,</span> <span class="mh">0x4A</span><span class="p">,</span> <span class="mh">0x9A</span><span class="p">,</span> <span class="mh">0xC3</span><span class="p">,</span> <span class="mh">0xC9</span><span class="p">,</span> <span class="mh">0x0E</span><span class="p">,</span> <span class="mh">0x3C</span><span class="p">,</span> <span class="mh">0x57</span><span class="p">,</span> <span class="mh">0xCC</span><span class="p">,</span> <span class="mh">0x68</span><span class="p">,</span> <span class="mh">0x76</span><span class="p">,</span> <span class="mh">0x67</span><span class="p">,</span> <span class="mh">0x84</span><span class="p">,</span> <span class="mh">0x0D</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0xA3</span><span class="p">,</span> <span class="mh">0xF0</span><span class="p">,</span> <span class="mh">0x22</span><span class="p">,</span> <span class="mh">0xBF</span><span class="p">,</span> <span class="mh">0x26</span><span class="p">,</span> <span class="mh">0x91</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x87</span><span class="p">,</span> <span class="mh">0x70</span><span class="p">,</span> <span class="mh">0xAE</span><span class="p">,</span> <span class="mh">0x3D</span><span class="p">,</span> <span class="mh">0x1D</span><span class="p">,</span> <span class="mh">0xC8</span><span class="p">,</span> <span class="mh">0x55</span><span class="p">,</span> <span class="mh">0x3E</span><span class="p">,</span> <span class="mh">0x37</span><span class="p">,</span> <span class="mh">0x23</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> <span class="mh">0x73</span><span class="p">,</span> <span class="mh">0x21</span><span class="p">,</span> <span class="mh">0x49</span><span class="p">,</span> <span class="mh">0x38</span><span class="p">,</span> <span class="mh">0x95</span><span class="p">,</span> <span class="mh">0x78</span><span class="p">,</span> <span class="mh">0xF8</span><span class="p">,</span> <span class="mh">0x18</span><span class="p">,</span> <span class="mh">0x56</span><span class="p">,</span> <span class="mh">0xCE</span><span class="p">,</span> <span class="mh">0x82</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ip</span> <span class="o">=</span> <span class="s1">&#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">resmp</span> <span class="o">=</span> <span class="s1">&#39;Rp5v+AZmM8XWy1sgNhTB/oCzYVdPrGn6KD3Q9lke4qtFxHb0uUOcS2jIEJfL7aiw&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">mp</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">64</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">ch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ip</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">mp</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">resmp</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">revMp</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">256</span> 
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">valMp</span><span class="p">,</span> <span class="n">resMp</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">revMp</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">revMap</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">bytes</span><span class="p">([</span><span class="n">revMp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">revmap</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">tmp</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">64</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mp</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">tmp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">MASK32</span> <span class="o">=</span> <span class="mh">0xFFFF_FFFF</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">rol</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">((</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="n">n</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">MASK32</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="mi">32</span> <span class="o">-</span> <span class="n">n</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">sh</span> <span class="o">=</span> <span class="mh">0x464c457f</span>
</span></span><span class="line"><span class="cl"><span class="n">passwd</span> <span class="o">=</span> <span class="mh">0x746f6f72</span>
</span></span><span class="line"><span class="cl"><span class="n">zero</span> <span class="o">=</span> <span class="p">(</span><span class="mh">0xffffffffffffffff</span> <span class="o">&gt;&gt;</span> <span class="mi">29</span><span class="p">)</span> <span class="o">//</span> <span class="mi">41</span>
</span></span><span class="line"><span class="cl"><span class="n">enc</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x526851a7</span><span class="p">,</span><span class="mh">0x31ff2785</span><span class="p">,</span><span class="mh">0xc7d28788</span><span class="p">,</span><span class="mh">0x523f23d3</span><span class="p">,</span><span class="mh">0xaf1f1055</span><span class="p">,</span><span class="mh">0x5c94f027</span><span class="p">,</span><span class="mh">0x797a3fcd</span><span class="p">,</span><span class="mh">0xe7f02f9f</span><span class="p">,</span><span class="mh">0x3c86f045</span><span class="p">,</span><span class="mh">0x6deab0f9</span><span class="p">,</span><span class="mh">0x91f74290</span><span class="p">,</span><span class="mh">0x7c9a3aed</span><span class="p">,</span><span class="mh">0xdc846b01</span><span class="p">,</span><span class="mh">0x0743c86c</span><span class="p">,</span><span class="mh">0xdff7085c</span><span class="p">,</span><span class="mh">0xa4aee3eb</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">enc</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">c</span> <span class="o">=</span> <span class="n">c</span><span class="o">^</span><span class="n">zero</span>
</span></span><span class="line"><span class="cl">    <span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="o">~</span><span class="n">c</span><span class="p">)</span><span class="o">&amp;</span><span class="n">MASK32</span>
</span></span><span class="line"><span class="cl">    <span class="n">c</span> <span class="o">=</span> <span class="n">rol</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">c</span> <span class="o">=</span> <span class="p">((</span><span class="n">c</span> <span class="o">^</span> <span class="n">passwd</span><span class="p">)</span> <span class="o">-</span> <span class="n">sh</span> <span class="p">)</span><span class="o">&amp;</span><span class="n">MASK32</span>
</span></span><span class="line"><span class="cl">    <span class="n">flag</span> <span class="o">+=</span> <span class="n">c</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;little&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">flag</span> <span class="o">=</span> <span class="n">revMap</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">flag</span> <span class="o">=</span> <span class="n">revmap</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span></code></pre></div>
      </article>

      




    </div>
  </div>
</div>

  </main>
  <footer class="flex flex-none justify-center">
    <section class="flex flex-col md:flex-row mx-2 md:mx-0 gap-2 md:gap-0 justify-between w-full max-w-4xl lg:max-w-5xl py-6 text-slate-500 dark:text-slate-300">
  <div class="flex flex-row">
    
  
  
  
  
  
  
  
  
  
  
  


  </div>
  <div class="grow"></div>
  <div class="flex flex-row">
    <i class="h-6 w-6 flex-none"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"></path>
   <path d="M14 9.75a3.016 3.016 0 0 0 -4.163 .173a2.993 2.993 0 0 0 0 4.154a3.016 3.016 0 0 0 4.163 .173"></path>
</svg>
</i> 2023 - 2024 
    
  </div>
  
</section>

  </footer>
  <script src="/main.js"></script>

<div class="hidden top-1 right-1" id="code-copy">
  <i class="h-6 w-6 block">
    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" />
  <path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" />
</svg>

  </i>
</div>
<div class="hidden top-1 right-1" id="code-copy-done">
  <i class="h-6 w-6 block">
    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-check" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M5 12l5 5l10 -10" />
</svg>

  </i>
</div><script src="/code-copy.js"></script>





</body>
</html>
